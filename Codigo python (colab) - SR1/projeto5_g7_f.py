# -*- coding: utf-8 -*-
"""projeto5_g7_f.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ZP7KaAWZ9hNW2IjXyiFcwUE_OsQtZe2a

# Projeto SR1 - An√°lise de Dados Or√ßament√°rios

Este notebook Colab segue o roteiro da Avalia√ß√£o T√©cnica SR1 para a **Compreens√£o do Conjunto de Dados**, focando nas etapas de descri√ß√£o, limpeza, contextualiza√ß√£o e an√°lise inicial.

## 1. Configura√ß√£o e Carregamento dos Dados
"""

import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.ticker as mtick
import numpy as np
import seaborn as sns

# Importando arquivo do github.
url = 'https://raw.githubusercontent.com/GuigaGibson/projeto5-colab/main/bancotsefinal.xlsx'

try:

  df = pd.read_excel(url)
  print("Arquivo carregado com sucesso diretamente do GitHub!")

except Exception as e:
  print(f"Ocorreu um erro ao tentar carregar o arquivo: {e}")

cidades = {
    "P093": "Limoeiro",
    "P098": "Moreno",
    "P110": "Paudalho"
}

"""##  Descri√ß√£o Inicial e Diagn√≥stico do Dataset

**Descri√ß√£o do dataset** (tamanho e estrutura) e **Compreens√£o das vari√°veis** (tipos de dados), este bloco verifica a integridade e a estrutura inicial do DataFrame. O diagn√≥stico dos nomes das colunas √© crucial para a limpeza subsequente.
"""

# Tamanho Dataset
print(f"O DataFrame foi carregado com sucesso. Ele possui {df.shape[0]} linhas e {df.shape[1]} colunas.")

#Tipos de dados iniciais (antes da limpeza)
print("\nTipos de dados iniciais das colunas:")
print(df.info())

#Primeiras linhas para visualiza√ß√£o da estrutura
print("\nPrimeiras 5 linhas do DataFrame para visualiza√ß√£o:")
display(df.head()) # 'display' √© melhor para o Colab/Jupyter

#Verificando os nomes originais (sa√≠da da leitura do arquivo)
print("\nNomes das colunas originais (para diagn√≥stico):\n", df.columns.tolist())

# Numero de linhas e colunas
num_linhas, num_colunas = df.shape
print(f"N√∫mero de linhas: {num_linhas}")
print(f"N√∫mero de colunas (vari√°veis): {num_colunas}")

# Tamanho total
tamanho_total = df.size
print(f"Tamanho total do dataset (c√©lulas): {tamanho_total}")

"""### Conclus√£o da An√°lise Inicial de Tipos de Dados (Se√ß√£o 2)

O DataFrame possui 21.804 registros e 36 colunas. A an√°lise inicial revela:

1.  **Vari√°veis Categ√≥ricas/Textuais (Object):** A maioria das colunas (22) √© do tipo `object`, o que inclui identificadores (como `CODIGO_MUNICIPIO`, `CPF_CNPJ`), descri√ß√µes (como `ACAO`, `FUNCAO`, `FORNECEDOR`) e as colunas com prefixos problem√°ticos (e.g., `resposta.conteudo.`).
2.  **Vari√°veis Num√©ricas:**
    * **Inteiras (`int64`):** Vari√°veis como ano (`ANOREFERENCIA`, `Ano`) e c√≥digos de identifica√ß√£o (`ID_EMPENHO`, `CODIGO_TIPO_ACAO`).
    * **Flutuantes (`float64`):** As colunas de valor (e.g., `VALOREMPENHADO`, `VALORPAGO`) e alguns c√≥digos que foram lidos como agregados (`Soma de...`) est√£o como `float64`, o que √© ideal para os valores monet√°rios.
3.  **Vari√°veis Temporais:** A coluna de data (`DATAEMPENHO` original) est√° ausente. Algumas vari√°veis temporais, como `M√™s` (Object) e `MESREFERENCIA` (Float), precisar√£o ser padronizadas ou combinadas para an√°lises temporais.

A pr√≥xima etapa (**Se√ß√£o 3**) ser√° dedicada √† limpeza desses nomes e √† garantia de que os tipos num√©ricos e de data estejam corretos.

# Limpeza Inicial, Padroniza√ß√£o e Convers√£o de Tipos

**ATEN√á√ÉO: Esta √© apenas uma Limpeza Inicial para Habilitar a An√°lise Explorat√≥ria.**

Nesta etapa, o foco √© a **padroniza√ß√£o dos nomes das colunas** e a **convers√£o de tipos de dados** essenciais:
* **Valores:** Colunas financeiras (`VALOREMPENHADO`, etc.) s√£o convertidas de texto formatado (ex: v√≠rgula/ponto) para o tipo num√©rico (`float64`).

Uma fase posterior ser√° dedicada √† Limpeza e Tratamento de Dados mais complexos (como imputa√ß√£o de valores faltantes, tratamento de *outliers* e padroniza√ß√£o de vari√°veis categ√≥ricas).
"""

# --- 1. Limpeza e Padroniza√ß√£o de Colunas ---

# Converter para string, remover espa√ßos extras e for√ßar mai√∫sculas (para consist√™ncia)
df.columns = df.columns.astype(str).str.strip().str.upper()

# remover os prefixos e padronizar
def limpar_nome_coluna(nome):
    # Remove os prefixos problem√°ticos. N√£o usa 'regex=False' pois √© str.replace nativo.
    nome = nome.replace('SOMA DE ', '')
    nome = nome.replace('RESPOSTA.CONTEUDO.', '')

    # Substitui espa√ßos e pontos por underscores para facilitar o acesso
    nome = nome.replace(' ', '_').replace('.', '_')

    # Remove underscores extras no in√≠cio/fim
    return nome.strip('_')

# Aplica a limpeza
df.columns = [limpar_nome_coluna(col) for col in df.columns]

print("Nomes das colunas limpos e padronizados com sucesso.")
print("Novos nomes das colunas:\n", df.columns.tolist())


# --- 2. Convers√£o de Tipos de Dados ---

# A lista usa os nomes limpos e padronizados
colunas_valor = ['VALORLIQUIDADO', 'VALORPAGO', 'VALOREMPENHADO']

# Convers√£o e Preenchimento para colunas de valor
for col in colunas_valor:
    if col in df.columns:
        # L√≥gica robusta para tratar n√∫meros formatados com separador de milhares (ponto) e decimal (v√≠rgula)
        try:
            # 1. Remove o separador de milhares (ponto)
            # 2. Substitui a v√≠rgula pelo ponto (separador decimal do Python)
            df[col] = df[col].astype(str).str.replace('.', '', regex=False).str.replace(',', '.', regex=False)

            # 3. Converte para num√©rico
            df[col] = pd.to_numeric(df[col], errors='coerce')
        except Exception as e:
            # Fallback simples em caso de erro na convers√£o
            df[col] = pd.to_numeric(df[col], errors='coerce')
    else:
        print(f"AVISO: Coluna de valor '{col}' n√£o encontrada no DataFrame ap√≥s a limpeza.")

# Preenche valores faltantes nas colunas num√©ricas com 0
df[colunas_valor] = df[colunas_valor].fillna(0)
print("Colunas de valor convertidas para num√©rico e preenchidas com 0.")


# Convers√£o de Coluna de Data
coluna_data = 'DATAEMPENHO'
if coluna_data in df.columns:
    df[coluna_data] = pd.to_datetime(df[coluna_data], errors='coerce')
    print(f"Coluna de data '{coluna_data}' convertida para datetime.")
else:
    print(f"AVISO: Coluna de data '{coluna_data}' n√£o encontrada no DataFrame.")

print("\nVerifica√ß√£o dos tipos de dados ap√≥s a limpeza:")
df.info()

"""### Conclus√£o da An√°lise Inicial de Tipos de Dados e Vari√°veis

O DataFrame consolidado possui 21.804 registros e 36 colunas. A an√°lise inicial revela:

1.  **Tipos de Dados:** A maioria das colunas descritivas est√° corretamente tipada como `object` (textual). As colunas de valor (e.g., `VALORPAGO`, `VALOREMPENHADO`) foram lidas como `float64`, o que √© apropriado para a fase explorat√≥ria. A coluna de data de empenho (`DATAEMPENHO`) est√° ausente no dataset.
2.  **Vari√°veis Categ√≥ricas Chave:**
    * A coluna **`FUNCAO`**, crucial para a an√°lise, cont√©m unicamente  a categoria **'EDUCA√á√ÉO'**, pois ja foi fatiada pelo proprio API do TCE-PE
    * As colunas de c√≥digo de munic√≠pio (`CODIGO_MUNICIPIO`) permitem a segmenta√ß√£o pelos tr√™s munic√≠pios de interesse.

A pr√≥xima etapa  √© a limpeza inicial dos nomes, corte de periodo e a convers√£o final de tipos para garantir a integridade dos dados para an√°lise.

## 2. Limpeza dos Dados

Esta fase inicia o **Tratamento de Inconsist√™ncias** e a **Padroniza√ß√£o** necess√°rias para a an√°lise, conforme o slide "Limpeza dos Dados".

Inicialmente sera feita um recorte do periodo entre 2022-2024. Para melhorar a analise do trabalho.
"""

# --- 1. FILTRO TEMPORAL (Restri√ß√£o de Uso) ---
# A√ß√µes: Eliminar linhas que n√£o sejam dos anos 2022, 2023, 2024.
anos_interesse = [2022, 2023, 2024]
coluna_ano_ref = 'ANOREFERENCIA'

if coluna_ano_ref in df.columns:
    df_antes = df.shape[0]
    # Filtra as linhas onde o ANOREFERENCIA est√° na lista de anos de interesse
    df = df[df[coluna_ano_ref].isin(anos_interesse)].copy()
    df_depois = df.shape[0]

    print(f"Filtro aplicado: Dados restritos aos anos {anos_interesse}.")
    print(f"Linhas removidas: {df_antes - df_depois} (Restantes: {df_depois} linhas).")
else:
    print(f"AVISO: Coluna de ano '{coluna_ano_ref}' n√£o encontrada. O filtro n√£o foi aplicado.")

"""### 2.2 Tratamento de Inconsist√™ncias (Nomes de Coluna e Tipos de Dados)

Os passos a seguir focam na padroniza√ß√£o de nomes (Tratamento de Inconsist√™ncias) e na convers√£o de colunas de valor (Corre√ß√£o de Erros Evidentes / Padroniza√ß√£o de Formatos) para preparar o dataset para a an√°lise num√©rica.
"""

# PADRONIZA√á√ÉO DE NOMES (Tratamento de Inconsist√™ncias - Nomes) ---

df.columns = df.columns.astype(str).str.strip().str.upper()

def limpar_nome_coluna(nome):
    # Remove prefixos problem√°ticos
    nome = nome.replace('SOMA DE ', '').replace('RESPOSTA.CONTEUDO.', '')
    # Padroniza nomes de colunas de resposta
    nome = nome.replace('RESPOSTA.ENTIDADE', 'RESPOSTA_ENTIDADE').replace('.', '_')
    # Substitui espa√ßos e pontos restantes por underscores
    nome = nome.replace(' ', '_').replace('.', '_')
    return nome.strip('_')

df.columns = [limpar_nome_coluna(col) for col in df.columns]

print("Nomes das colunas limpos e padronizados com sucesso.")


# EXCLUS√ÉO DE COLUNAS N√ÉO ESSENCIAIS (Redu√ß√£o de Dimensionalidade) ---
colunas_para_remover = [
    'CODIGO_TIPO_EMPENHO',
    'ELEMENTODESPESA',
    'ESFERA',
    'ID_UNIDADE_GESTORA',
    'ID_EMPENHO',
    'NATUREZA',
    'NUMEROEMPENHO',
    'RESPOSTA_ENTIDADE',
    'RESPOSTA_LIMITERESULTADO',
    'RESPOSTA_STATUS',
    'RESPOSTA_TAMANHORESULTADO'
]

colunas_existentes = [col for col in colunas_para_remover if col in df.columns]

if colunas_existentes:
    df = df.drop(columns=colunas_existentes)
    print(f"Colunas removidas com sucesso: {colunas_existentes}")
else:
    print("AVISO: Nenhuma das colunas especificadas foi encontrada para remo√ß√£o.")


print("\n--- LISTA FINAL DE COLUNAS AP√ìS LIMPEZA E EXCLUS√ÉO ---")
# Exibe a lista completa de nomes de colunas padronizados
print(df.columns.tolist())
print(f"Total de colunas restantes: {len(df.columns)}")

# 2. Distribui√ß√£o por CIDADE (Vari√°vel Mapeada - Se Existente)
if 'CIDADE' in df.columns:
    print("Distribui√ß√£o e Quantidade das recorr√™ncias por NOME DA CIDADE:")
    # O .value_counts() lista e conta, e o .head(4) limita aos 4 mais frequentes.
    print(df['CIDADE'].value_counts().head(3))
else:
    print("AVISO: A coluna 'CIDADE' (com os nomes Limoeiro, Moreno, Paudalho) n√£o foi encontrada no DataFrame. ")
    print("Ela √© geralmente criada por mapeamento do CODIGO_MUNICIPIO.")

"""### 2.3 Padroniza√ß√£o de Formatos e Tratamento de Ausentes

Esta etapa final de limpeza foca na convers√£o de tipos (garantindo que colunas financeiras sejam num√©ricas) e no **tratamento de valores ausentes** nas colunas de valor, antes da fase explorat√≥ria.
"""

#--- Convers√£o segura das colunas de valor ---
colunas_valor = ['VALORLIQUIDADO', 'VALORPAGO', 'VALOREMPENHADO']

for col in colunas_valor:
    if col in df.columns:
        try:
            # Remove apenas v√≠rgula decimal (n√£o mexe em ponto se j√° for separador correto)
            df[col] = (
                df[col]
                .astype(str)
                .str.replace('\xa0', '', regex=False)  # remove espa√ßos n√£o quebr√°veis
                .str.replace(',', '.', regex=False)    # v√≠rgula decimal ‚Üí ponto
                .str.replace('[^0-9.]', '', regex=True)  # mant√©m s√≥ n√∫meros e ponto
            )

            # Converte para float de forma segura
            df[col] = pd.to_numeric(df[col], errors='coerce')

        except Exception as e:
            print(f"Erro ao converter {col}: {e}")

#Substitui ausentes por 0
df[colunas_valor] = df[colunas_valor].fillna(0)
print("‚úÖ Colunas de valor convertidas corretamente para num√©rico e preenchidas com 0.")

# Convers√£o de Data (tentativa de padroniza√ß√£o)
coluna_data = 'DATAEMPENHO'
if coluna_data in df.columns:
    df[coluna_data] = pd.to_datetime(df[coluna_data], errors='coerce')
    print(f"Coluna de data '{coluna_data}' convertida para datetime.")
else:
    print(f"AVISO: Coluna de data '{coluna_data}' n√£o encontrada no DataFrame.")


condicao_negativos = (df[colunas_valor] < 0).any(axis=1)
qtd_negativos = condicao_negativos.sum()

if qtd_negativos > 0:
    print(f"‚ö†Ô∏è {qtd_negativos} registros com valores negativos detectados. Removendo do DataFrame...")
    df = df[~condicao_negativos].copy()
else:
    print("‚úÖ Nenhum valor negativo encontrado nas colunas monet√°rias.")

print("\n--- Verifica√ß√£o final dos tipos de dados ap√≥s limpeza ---")
df.info()
print("\nVerifica√ß√£o final dos tipos de dados ap√≥s a limpeza:")
df.info()

"""Analisando a forma de escrita das categorias de subfuncao"""

# Garante que a coluna 'FUNCAO' seja tratada como texto
df['FUNCAO'] = df['FUNCAO'].astype(str).str.strip()
df['SUBFUNCAO'] = df['SUBFUNCAO'].astype(str).str.strip()


print("--- Categorias √önicas na Coluna 'FUNCAO' ---")
# O comando .unique() cria uma lista com cada nome de fun√ß√£o que aparece no arquivo, sem repeti√ß√µes.
funcoes_unicas = df['FUNCAO'].unique()
print(funcoes_unicas)

print("\n\n--- Contagem de Registros por 'FUNCAO' (As 15 mais comuns) ---")
contagem_funcoes = df['FUNCAO'].value_counts()
print(contagem_funcoes.head(15))


print("\n\n--- Contagem de Registros por 'SUBFUNCAO' (As 20 mais comuns) ---")
contagem_subfuncoes = df['SUBFUNCAO'].value_counts()
print(contagem_subfuncoes.head(20))

# Gera uma lista Python com todos os nomes √∫nicos da coluna
lista_de_funcoes = df['FUNCAO'].unique().tolist()
print(lista_de_funcoes)
lista_de_funcoes = df['SUBFUNCAO'].unique().tolist()
print(lista_de_funcoes)

df['CODIGO_MUNICIPIO'] = df['CODIGO_MUNICIPIO'].astype(str).str.strip()

# 2. Cria a coluna 'CIDADE' aplicando o mapeamento
# Se a coluna 'CIDADE' j√° existir, ela ser√° sobrescrita.
df['CIDADE'] = df['CODIGO_MUNICIPIO'].apply(lambda cod: cidades.get(cod, 'Outras/N√£o Identificada'))

# 3. Confirma√ß√£o do sucesso
print("Mapeamento das cidades (P093, P098, P110) conclu√≠do com sucesso.")
print("A coluna 'CIDADE' foi criada no DataFrame principal ('df').")

# Verifica√ß√£o (opcional)
print("\nPrimeiros 5 registros de MUNIC√çPIO e CIDADE para confer√™ncia:")
display(df[['CODIGO_MUNICIPIO', 'CIDADE']].head())

"""## Faremos a correcao a partir de um dicionario, para substituicao de caracteres indevidos"""

# Mapearemos a palavra errada para a palavra correta
mapa_de_correcao = {

    'EducaÔøΩÔøΩo': 'EDUCA√á√ÉO',

    'EducaÔøΩÔøΩo de Jovens e Adultos': 'EDUCA√á√ÉO DE JOVENS E ADULTOS',
    'ServiÔøΩo da DÔøΩvida Interna': 'SERVI√áO DA D√çVIDA INTERNA',
    'Ensino Fundamental': 'ENSINO FUNDAMENTAL',
    'Ensino Superior': 'ENSINO SUPERIOR',
    'AdministraÔøΩÔøΩo Geral': 'ADMINISTRA√á√ÉO GERAL',
    'EducaÔøΩÔøΩo Infantil': 'EDUCA√á√ÉO INFANTIL',
    'AlimentaÔøΩÔøΩo e NutriÔøΩÔøΩo': 'ALIMENTA√á√ÉO E NUTRI√á√ÉO',
    'EducaÔøΩÔøΩo BÔøΩsica': 'EDUCA√á√ÉO B√ÅSICA',

    'DifusÔøΩo Cultural': 'DIFUS√ÉO CULTURAL',
    'EducaÔøΩÔøΩo Especial': 'EDUCA√á√ÉO ESPECIAL',
    'FormaÔøΩÔøΩo de Recursos Humanos': 'FORMA√á√ÉO DE RECURSOS HUMANOS'

}

colunas_para_corrigir = ['FUNCAO', 'SUBFUNCAO', 'PROGRAMA', 'NOMEUNIDADEGESTORA', 'FORNECEDOR', 'HISTORICO']

for coluna in colunas_para_corrigir:
    if coluna in df.columns: # Apenas se a coluna existir
        df[coluna] = df[coluna].replace(mapa_de_correcao)

print("‚úÖ Corre√ß√£o manual aplicada!")


# Verificacao final
print("\n--- Verifica√ß√£o FINAL da coluna 'FUNCAO' ---")
print(df['FUNCAO'].value_counts().head(20))

print("\n--- Verifica√ß√£o FINAL da coluna 'SUBFUNCAO' ---")
print(df['SUBFUNCAO'].value_counts().head(30))

"""Feita a limpeza agora inicia-se a analise preliminar

## 3. An√°lise Preliminar

Esta fase √© dedicada √† **An√°lise Preliminar**, focando na obten√ß√£o de **Estat√≠sticas descritivas** (m√©dias, medianas, desvios) e na **Explora√ß√£o de correla√ß√µes** e **padr√µes iniciais** (tend√™ncias e varia√ß√µes). O objetivo √© gerar **insights iniciais** sobre a distribui√ß√£o dos recursos da fun√ß√£o 'EDUCA√á√ÉO' por munic√≠pio.

### 3.1 Estat√≠sticas Descritivas e Agrega√ß√£o por Munic√≠pio e Ano

Ser√£o calculadas estat√≠sticas descritivas para a vari√°vel `VALORPAGO`, agrupadas pela combina√ß√£o de `CIDADE` e `ANOREFERENCIA`.
"""

# --- REVERS√ÉO E NOVA TRANSFORMA√á√ÉO GLOBAL E PERMANENTE ---
coluna_valor = 'VALORPAGO'
coluna_cidade = 'CIDADE'
funcao_alvo = 'EDUCA√á√ÉO'


# 2. Aplica a nova transforma√ß√£o: divide todos os valores da coluna VALORPAGO por 1000 no DF PRINCIPAL
df[coluna_valor] = df[coluna_valor] / 1000

print(f"VALORPAGO no DF completo ap√≥s a divis√£o por 1000 (Exemplo): {df[coluna_valor].head().to_string(index=False)}")
print("\nAVISO CR√çTICO: O DataFrame original 'df' foi reajustado e PERMANENTEMENTE modificado. Todos os valores de VALORPAGO s√£o agora 1000 vezes menores.")

# --- IN√çCIO DA AN√ÅLISE (Estat√≠sticas Descritivas) ---

# 3. Filtra apenas os registros da fun√ß√£o EDUCA√á√ÉO (agora com valores j√° divididos por 1000)
df_educacao = df[df['FUNCAO'] == funcao_alvo].copy()

if df_educacao.empty:
    print(f"\nAVISO: Nenhum registro encontrado para FUN√á√ÉO='{funcao_alvo}'.")
else:

    print(f"\n--- ESTAT√çSTICAS DESCRITIVAS ATUALIZADAS (FUN√á√ÉO: {funcao_alvo}) POR CIDADE ---")

    # 4. Usa .describe() para gerar estat√≠sticas por cidade
    df_descritivas = (
        df_educacao.groupby(coluna_cidade)[coluna_valor]
        .describe(percentiles=[0.25, 0.5, 0.75])
        .reset_index()
    )

    # 5. Renomeia colunas para portugu√™s
    df_descritivas = df_descritivas.rename(columns={
        'count': 'Contagem',
        'mean': 'M√©dia',
        'std': 'Desvio_Padr√£o',
        'min': 'M√≠nimo',
        '25%': '1¬∫ Quartil (25%)',
        '50%': 'Mediana (50%)',
        '75%': '3¬∫ Quartil (75%)',
        'max': 'M√°ximo'
    })

    # 6. Formata valores monet√°rios (R$ X.XXX,XX)
    for col in ['M√©dia', 'Desvio_Padr√£o', 'M√≠nimo', '1¬∫ Quartil (25%)',
                'Mediana (50%)', '3¬∫ Quartil (75%)', 'M√°ximo']:
        df_descritivas[col] = df_descritivas[col].apply(lambda x: f'R$ {x:,.2f}' if pd.notnull(x) else '-')

    display(df_descritivas)

    # 7. Mostrar a soma total por cidade
    print("\n--- TOTAL GASTO EM EDUCA√á√ÉO POR CIDADE (SOMA DE TODOS OS ANOS) ---")
    df_soma = (
        df_educacao.groupby(coluna_cidade)[coluna_valor]
        .sum()
        .reset_index()
        .rename(columns={coluna_valor: 'Total_Gasto'})
        .sort_values(by='Total_Gasto', ascending=False)
    )

    # Formata√ß√£o R$ X.XXX.XXX,XX (Valor total na nova escala, dividida por 1000)
    df_soma['Total_Gasto'] = df_soma['Total_Gasto'].apply(lambda x: f'R$ {x:,.2f}')
    display(df_soma)



"""### 3.2 Explora√ß√£o de Padr√µes e Discuss√£o de Insights Iniciais

O foco √© na **Explora√ß√£o de correla√ß√µes** e na **Identifica√ß√£o de padr√µes iniciais**, usando os gastos agregados para analisar a **evolu√ß√£o e varia√ß√£o temporal** entre os munic√≠pios.
"""

# --- EXPLORA√á√ÉO DE CORRELA√á√ïES E IDENTIFICA√á√ÉO DE PADR√ïES INICIAIS ---
# Usando os gastos agregados para analisar a evolu√ß√£o e varia√ß√£o temporal entre os munic√≠pios.

# --- Pr√©-requisito: Gasto Total Anual por Cidade (Necess√°rio para a Varia√ß√£o) ---
coluna_valor = 'VALORPAGO'
colunas_agrupamento = ['CIDADE', 'ANOREFERENCIA']
funcao_alvo = 'EDUCA√á√ÉO'

# Filtra apenas a fun√ß√£o de interesse
df_analise = df[df['FUNCAO'] == funcao_alvo].copy()

# Agrega√ß√£o do gasto total anual (BASE NUM√âRICA)
df_gastos_agregados = (
    df_analise
    .groupby(colunas_agrupamento)[coluna_valor]
    .sum()
    .reset_index()
)

# Cria√ß√£o da tabela piv√¥ (CIDADE x ANO)
tabela_numerica = df_gastos_agregados.pivot_table(
    index='CIDADE',
    columns='ANOREFERENCIA',
    values=coluna_valor,
    aggfunc='sum'
)

# --- An√°lise de Varia√ß√£o Percentual (Explora√ß√£o de correla√ß√µes / padr√µes) ---
print("--- AN√ÅLISE DE VARIA√á√ÉO PERCENTUAL DE GASTO ANUAL (2022-2024) ---")

# C√°lculo da varia√ß√£o percentual ano a ano
variacao_22_23 = (
    (tabela_numerica.get(2023, 0) - tabela_numerica.get(2022, 0))
    / tabela_numerica.get(2022, np.nan)
)

variacao_23_24 = (
    (tabela_numerica.get(2024, 0) - tabela_numerica.get(2023, 0))
    / tabela_numerica.get(2023, np.nan)
)

# Consolida as varia√ß√µes em um √∫nico DataFrame
df_variacao = pd.concat([
    variacao_22_23.rename('VARIA√á√ÉO_2022_2023'),
    variacao_23_24.rename('VARIA√á√ÉO_2023_2024')
], axis=1)

# Substitui infinitos e NaN por valores nulos antes da formata√ß√£o
df_variacao = df_variacao.replace([np.inf, -np.inf], np.nan)

# Formata a sa√≠da em porcentagem para clareza visual
df_variacao_formatada = df_variacao.map(
    lambda x: f'{x:.1%}' if pd.notna(x) and not np.isinf(x) else 'N/A'
)

# Exibe a tabela formatada
display(df_variacao_formatada)

"""--- DISCUSS√ÉO DE INSIGHTS INICIAIS (INTERPRETA√á√ÉO DOS PADR√ïES) ---
1. Outliers e Dispers√£o: A diferen√ßa entre m√©dia e mediana (ver bloco 3.1) sugere que poucos registros de alto valor elevam o gasto m√©dio, indicando a presen√ßa de outliers.
2. Padr√£o de Evolu√ß√£o: Varia√ß√µes positivas indicam crescimento do gasto entre os anos. J√° valores negativos, como observado em Moreno (2023‚Äì2024), representam retra√ß√£o or√ßament√°ria ou execu√ß√£o parcial do recurso.
3. Concentra√ß√£o de Gasto: A cidade com maior gasto absoluto (do bloco 3.1) deve ser comparada √† contagem de transa√ß√µes, para avaliar se o gasto est√° distribu√≠do ou concentrado em poucos contratos.
4. Correla√ß√£o Temporal: Munic√≠pios com crescimento consistente sugerem maior estabilidade financeira ou maior efici√™ncia na execu√ß√£o or√ßament√°ria.

### 3.3 An√°lise e Explora√ß√£o das Vari√°veis Categ√≥ricas e Num√©ricas

Nesta etapa da an√°lise explorat√≥ria, buscou-se compreender como as vari√°veis categ√≥ricas ‚Äî como **CIDADE, ANOREFERENCIA e SUBFUNCAO**   ‚Äî se relacionam com a vari√°vel num√©rica principal **VALORPAGO**, que representa o montante efetivamente desembolsado na fun√ß√£o Educa√ß√£o.

O objetivo foi identificar padr√µes de comportamento or√ßament√°rio e diferen√ßas estruturais entre os munic√≠pios e suas √°reas de atua√ß√£o, verificando como o valor pago varia conforme o contexto institucional e funcional.

####  Distribui√ß√£o do Gasto por Munic√≠pio

A partir dessa an√°lise, observou-se que o **VALORPAGO** apresenta distribui√ß√µes distintas entre as categorias, refletindo o porte e a capacidade de execu√ß√£o or√ßament√°ria de cada munic√≠pio:

* Em **Paudalho**, os valores s√£o mais elevados e dispersos, indicando maior amplitude de contratos e diversidade de despesas.
* Em **Moreno**, a concentra√ß√£o em faixas m√©dias sugere estabilidade e foco em custeio recorrente.
* J√° em **Limoeiro**, h√° menor dispers√£o e predomin√¢ncia de pagamentos uniformes, sinalizando execu√ß√£o mais controlada e previs√≠vel.

####  Impacto das Subfun√ß√µes

Entre as subfun√ß√µes, destaca-se a forte predomin√¢ncia do **Ensino Fundamental**, respons√°vel pela maior parcela dos valores pagos, seguida por Educa√ß√£o Infantil e Alimenta√ß√£o Escolar, com propor√ß√µes significativamente menores. Essa distribui√ß√£o refor√ßa o car√°ter estruturalmente concentrado do gasto educacional municipal, direcionado majoritariamente √† manuten√ß√£o do ensino b√°sico.

####  Padr√µes Temporais e Estruturais

A an√°lise cruzada tamb√©m permitiu identificar padr√µes temporais ‚Äî com **crescimento gradual dos valores pagos entre 2022 e 2024** ‚Äî e diferen√ßas de intensidade entre as categorias de munic√≠pio, evidenciando a influ√™ncia de fatores como capacidade fiscal, prioriza√ß√£o pol√≠tica e estrutura administrativa.

Em s√≠ntese, a intera√ß√£o entre as vari√°veis categ√≥ricas e num√©ricas revela **heterogeneidade de comportamento or√ßament√°rio**, mas **homogeneidade na estrutura de gasto**, demonstrando que, embora os valores variem, a l√≥gica de aplica√ß√£o permanece concentrada nas despesas de pessoal e manuten√ß√£o do ensino regular.

## 4. Processo de Visualiza√ß√£o

Esta fase √© dedicada √† **Visualiza√ß√£o de Dados**, utilizando gr√°ficos para refor√ßar os *insights* obtidos na An√°lise Preliminar (Sess√£o 3).

### 4.1 Visualiza√ß√£o Univariada: Gasto Total Consolidado por Cidade

O gr√°fico de barras √© a **Escolha adequada de gr√°ficos** para comparar o volume absoluto de `VALORPAGO` entre as tr√™s cidades no per√≠odo total (2022-2024).
"""

# --- Pr√©-requisito: Agrega√ß√£o do Gasto Total (2022-2024) ---
coluna_valor = 'VALORPAGO'
funcao_alvo = 'EDUCA√á√ÉO'

# 1. Filtra apenas os registros da fun√ß√£o EDUCA√á√ÉO
df_educacao = df[df['FUNCAO'] == funcao_alvo].copy()

# 2. Calcula a soma total do VALORPAGO, agrupada apenas por CIDADE
df_gasto_total = (
    df_educacao.groupby('CIDADE')[coluna_valor]
    .sum()
    .reset_index()
    .rename(columns={coluna_valor: 'Gasto_Total_Consolidado'})
    # Ordena pelo gasto decrescente (do maior para o menor)
    .sort_values(by='Gasto_Total_Consolidado', ascending=False)
)

# --- Gera√ß√£o do Gr√°fico de Barras Horizontal ---
plt.figure(figsize=(10, 6))

# CORES PERSONALIZADAS: Azul (#3055a0), Amarelo (#fab331), Vermelho (#bc4a49)
cores_personalizadas = ['#3055a0', '#fab331', '#bc4a49']

ax = sns.barplot(
    data=df_gasto_total,
    x='Gasto_Total_Consolidado',
    y='CIDADE',
    palette=cores_personalizadas,
    orient='h'
)

# Formata√ß√£o do Eixo X em Milh√µes de R$ (Clareza visual)
def millions_formatter(x, pos):
    return f'R$ {x/1000000:,.1f}M'
formatter = mtick.FuncFormatter(millions_formatter)
plt.gca().xaxis.set_major_formatter(formatter)


# --- Adi√ß√£o dos R√≥tulos de Valor DENTRO da Caixa (Cor Branca para Contraste) ---
for container in ax.containers:
    for bar in container:
        width = bar.get_width()
        label_text = f'R$ {width/1000000:,.2f}M'

        # Posi√ß√£o X ligeiramente √† direita do in√≠cio da barra (dentro dela)
        ax.text(
            width * 0.02,
            bar.get_y() + bar.get_height() / 2,
            label_text,
            ha='left',
            va='center',
            fontsize=11,
            color='white', # Mantendo cor branca para contraste com as novas cores
            weight='bold'
        )

plt.title(f'Gasto Total Consolidado (2022-2024) em {funcao_alvo} por Munic√≠pio', fontsize=16, weight='bold')
plt.xlabel('Valor Pago Total (R$ Milh√µes)', fontsize=12)
plt.ylabel('Cidade', fontsize=12)
plt.grid(axis='x', linestyle='--', alpha=0.6)
plt.tight_layout()
plt.show()

"""### 4.2 Boxplot para Distribui√ß√£o de Gastos e An√°lise de Outliers

O Boxplot (gr√°fico de dispers√£o univariada) √© utilizado para analisar a **distribui√ß√£o das vari√°veis** de `VALORPAGO` por transa√ß√£o, por cidade. A escala logar√≠tmica limitada (`< log 8`) permite uma visualiza√ß√£o detalhada da densidade dos valores mais baixos, enquanto ainda mostra a presen√ßa de *outliers* de alto valor.
"""

# --- Pr√©-requisito: Filtro e Mapeamento ---
coluna_valor = 'VALORPAGO'
coluna_log = 'LOG10_VALOR'
funcao_alvo = 'EDUCA√á√ÉO'
cidades_interesse = ['Limoeiro', 'Moreno', 'Paudalho']

df_plot = df[(df['FUNCAO'] == funcao_alvo) & (df['CIDADE'].isin(cidades_interesse))].copy()

if df_plot.empty:
    print(f"\nAVISO: O DataFrame para plotagem (FUNCAO='{funcao_alvo}' nas cidades de interesse) est√° vazio.")
else:
    # 1. CRIA√á√ÉO DA NOVA COLUNA DE M√âTRICA
    # Aplica log10(1 + valor) para lidar com a compress√£o e valores zero.
    df_plot[coluna_log] = np.log10(1 + df_plot[coluna_valor])

    # --- Configura√ß√µes do Boxplot ---
    cores_personalizadas = {
        'Paudalho': '#3055a0', # Azul
        'Moreno': '#fab331',   # Amarelo
        'Limoeiro': '#bc4a49'  # Vermelho
    }

    plt.figure(figsize=(8, 5))

    # 2. Gera√ß√£o do Boxplot na Nova M√©trica
    sns.boxplot(
        data=df_plot,
        x=coluna_log, # Usamos a nova coluna transformada
        y='CIDADE',
        palette=cores_personalizadas,
        order=['Paudalho', 'Moreno', 'Limoeiro']
    )

    # 3. Formata√ß√£o do T√≠tulo e Eixos (Clareza visual)
    plt.title(
        'Distribui√ß√£o Logar√≠tmica dos Valores Pagos em Educa√ß√£o por Cidade',
        fontsize=14,
        weight='bold'
    )
    plt.xlabel('Log10(1 + Valor Pago)', fontsize=10)
    plt.ylabel('Cidade', fontsize=10)
    plt.grid(axis='x', linestyle='--', alpha=0.6)

    plt.tight_layout()
    plt.show()

    # --- Interpreta√ß√£o (Discuss√£o de insights iniciais) ---
    print("\nINSIGHTS DO BOXPLOT COM TRANSFORMA√á√ÉO DE M√âTRICA:")
    print("1. Nova Mediana: A linha central (mediana) agora representa o logaritmo do valor t√≠pico pago, facilitando a compara√ß√£o direta.")
    print("2. Vis√£o de Dispers√£o: A amplitude das caixas e dos *whiskers* (hastes) mostra o qu√£o espalhada est√° a distribui√ß√£o dos valores logar√≠tmicos.")

"""Devido a dificuldade de visualizacao utilizaremos o metodo de Violino.

"""

# --- Pr√©-requisito: Cria√ß√£o da M√©trica Logar√≠tmica ---
coluna_log = 'LOG10_VALOR'
funcao_alvo = 'EDUCA√á√ÉO'
cidades_interesse = ['Limoeiro', 'Moreno', 'Paudalho']

df_plot = df[(df['FUNCAO'] == funcao_alvo) & (df['CIDADE'].isin(cidades_interesse))].copy()

if df_plot.empty:
    print(f"\nAVISO: O DataFrame para plotagem (FUNCAO='{funcao_alvo}' nas cidades de interesse) est√° vazio.")
else:
    # Garante que a coluna logar√≠tmica exista para a plotagem
    if coluna_log not in df_plot.columns:
        df_plot[coluna_log] = np.log10(1 + df_plot['VALORPAGO'])

    # --- Configura√ß√µes do Gr√°fico de Violino ---
    cores_personalizadas = {
        'Paudalho': '#3055a0', # Azul
        'Moreno': '#fab331',   # Amarelo
        'Limoeiro': '#bc4a49'  # Vermelho
    }

    plt.figure(figsize=(8, 5))

    # 1. Gera√ß√£o do Gr√°fico de Violino (Violin Plot)
    sns.violinplot(
        data=df_plot,
        x=coluna_log,
        y='CIDADE',
        palette=cores_personalizadas,
        order=['Paudalho', 'Moreno', 'Limoeiro'],
        inner='quartile' # Mostra a mediana e os quartis dentro do violino
    )

    # 2. Formata√ß√£o do T√≠tulo e Eixos (Clareza visual)
    plt.title(
        'Distribui√ß√£o da Densidade de Valores Pagos (M√©trica Logar√≠tmica)',
        fontsize=14,
        weight='bold'
    )
    plt.xlabel('Log10(1 + Valor Pago)', fontsize=10)
    plt.ylabel('Cidade', fontsize=10)
    plt.grid(axis='x', linestyle='--', alpha=0.6)

    plt.tight_layout()
    plt.show()

    # --- Interpreta√ß√£o (Discuss√£o de insights iniciais) ---
    print("\nINSIGHTS DO GR√ÅFICO DE VIOLINO:")
    print("1. Densidade: O formato largo do 'corpo' do violino na extremidade esquerda (valores logar√≠tmicos baixos) confirma a enorme concentra√ß√£o de transa√ß√µes de baixo valor.")
    print("2. Distribui√ß√£o: O gr√°fico de violino mostra que, embora a mediana seja baixa, a distribui√ß√£o de Moreno (Amarelo) √© mais ampla em valores maiores que Limoeiro, indicando maior variabilidade de gastos.")

"""
O gr√°fico de violino refor√ßa os padr√µes de distribui√ß√£o e variabilidade dos gastos:

* **Concentra√ß√£o da Despesa:** O formato estreito do "corpo" dos violinos em valores logar√≠tmicos baixos confirma que a **maioria esmagadora** das transa√ß√µes em Limoeiro, Moreno e Paudalho s√£o de valores pequenos.
* **Diferen√ßa de Variabilidade (Moreno):** O violino de Moreno (Amarelo) √© visivelmente mais largo e disperso em valores logar√≠tmicos maiores. Isso indica uma **maior variabilidade** e frequ√™ncia de transa√ß√µes de valores m√©dios na cidade.
* **Limoeiro (Extrema Concentra√ß√£o):** Limoeiro (Vermelho) tem a distribui√ß√£o mais concentrada e estreita, apontando para a **menor variabilidade** nos valores de pagamento.
* **Outliers Extremos:** As longas caudas em todas as cidades confirmam a presen√ßa de *outliers* de alt√≠ssimo valor, crucial para a etapa de **Corre√ß√£o de erros evidentes**.

###  Identifica√ß√£o de Limita√ß√µes do Conjunto de Dados

Para cumprir o objetivo de medir a "evolu√ß√£o" de forma eficaz, o conjunto de dados apresenta as seguintes limita√ß√µes:

1.  **Aus√™ncia de Vari√°veis de Contexto Financeiro:**
    * N√£o h√° dados sobre o **Or√ßamento Total** de cada munic√≠pio. A an√°lise est√° limitada √† compara√ß√£o de valores absolutos (`VALORPAGO`) e n√£o √† **propor√ß√£o** do gasto em Educa√ß√£o.
2.  **Aus√™ncia de Vari√°veis de Resultado:**
    * N√£o h√° m√©tricas de efici√™ncia ou resultado educacional (ex: IDEB). Isso impede que a "evolu√ß√£o" do gasto seja correlacionada com a **efetividade** da despesa.
3.  **Restri√ß√µes de Uso:**
    * A an√°lise se restringe a apenas **tr√™s munic√≠pios** e ao per√≠odo **2022-2024**, limitando a generaliza√ß√£o das conclus√µes.
4.  **Impacto dos Outliers:**
    * A alta dispers√£o do `VALORPAGO` (conforme visto no violino e no boxplot) indica que o *outlier* tem um impacto desproporcional na m√©dia, exigindo tratamento rigoroso em etapas futuras.

Estes pontos definem os limites da an√°lise atual e indicam a necessidade de **incorporar dados externos** para aprofundamento em fases subsequentes."""

# --- Configura√ß√µes b√°sicas ---
coluna_valor = 'VALORPAGO'
colunas_agrupamento = ['CIDADE', 'ANOREFERENCIA']
funcao_alvo = 'EDUCA√á√ÉO'

# --- 1Ô∏è‚É£ Padroniza√ß√£o dos valores monet√°rios ---
if df[coluna_valor].dtype == 'object':
    df[coluna_valor] = (
        df[coluna_valor]
        .astype(str)
        .str.replace('\xa0', '', regex=False)          # remove espa√ßos n√£o quebr√°veis
        .str.replace('.', '', regex=False)             # remove pontos de milhar
        .str.replace(',', '.', regex=False)            # substitui v√≠rgula decimal por ponto
        .str.replace('[^0-9\.]', '', regex=True)       # mant√©m s√≥ n√∫meros e ponto
    )
    df[coluna_valor] = pd.to_numeric(df[coluna_valor], errors='coerce')

# Substitui valores ausentes por zero
df[coluna_valor] = df[coluna_valor].fillna(0)

# --- 2Ô∏è‚É£ Filtragem apenas para EDUCA√á√ÉO ---
df_educacao = df[df['FUNCAO'] == funcao_alvo].copy()

# --- 3Ô∏è‚É£ Agrega√ß√£o: soma total por cidade e ano ---
df_gasto_anual = (
    df_educacao
    .groupby(colunas_agrupamento)[coluna_valor]
    .sum()
    .reset_index()
)

# --- 4Ô∏è‚É£ Paleta de cores personalizada ---
cores_personalizadas = {
    'Paudalho': '#3055a0',  # azul
    'Limoeiro': '#bc4a49',  # vermelho
    'Moreno': '#fab331'     # amarelo
}

# --- 5Ô∏è‚É£ Cria√ß√£o do gr√°fico ---
plt.figure(figsize=(10, 6))
ax = sns.barplot(
    data=df_gasto_anual,
    x='ANOREFERENCIA',
    y=coluna_valor,
    hue='CIDADE',
    palette=cores_personalizadas
)

# --- 6Ô∏è‚É£ Formata√ß√£o do eixo Y em milh√µes de reais ---
def millions_formatter(x, pos):
    return f'R$ {x/1_000_000:,.1f}M'
ax.yaxis.set_major_formatter(mtick.FuncFormatter(millions_formatter))

# --- 7Ô∏è‚É£ R√≥tulos dentro das barras, formatados verticalmente ---
for container in ax.containers:
    # Ajuste fino do valor vertical para centralizar dentro das barras
    ax.bar_label(
        container,
        labels=[f'R$ {v.get_height():,.0f}'.replace(',', 'X').replace('.', ',').replace('X', '.')
                for v in container],  # converte para padr√£o brasileiro
        label_type='center',
        fontsize=9,
        color='white',
        weight='bold',
        rotation=90,      # texto na vertical
        padding=2
    )

# --- 8Ô∏è‚É£ Ajustes visuais e t√≠tulo ---
plt.title('Gasto Anual em Educa√ß√£o por Munic√≠pio (2022‚Äì2024)', fontsize=15, weight='bold')
plt.xlabel('Ano de Refer√™ncia', fontsize=12)
plt.ylabel('Valor Pago (R$ Milh√µes)', fontsize=12)
plt.legend(title='Munic√≠pio', fontsize=10)
plt.grid(axis='y', linestyle='--', alpha=0.6)
plt.tight_layout()
plt.show()

"""## Insight ‚Äî Evolu√ß√£o do Gasto Anual em Educa√ß√£o (2022‚Äì2024)

O comportamento dos gastos p√∫blicos em Educa√ß√£o entre 2022 e 2024 evidencia um **crescimento consistente e cont√≠nuo** nos tr√™s munic√≠pios analisados ‚Äî Paudalho, Limoeiro e Moreno ‚Äî, com destaque para a expans√£o mais acelerada de Paudalho, que atinge o maior volume absoluto em 2024.

### An√°lise por Munic√≠pio

üîπ **Paudalho** apresenta uma trajet√≥ria de forte crescimento acumulado, passando de 65,9 milh√µes de reais em 2022 para 92,6 milh√µes de reais em 2024 ‚Äî um aumento de aproximadamente 40% em dois anos. Esse avan√ßo reflete expans√£o de programas educacionais, incremento de infraestrutura e aumento da folha de pessoal, al√©m de poss√≠vel execu√ß√£o ampliada de recursos vinculados √† educa√ß√£o b√°sica.

üîπ **Limoeiro** segue um padr√£o de crescimento est√°vel e gradual, evoluindo de 54,2 milh√µes de reais para 70,2 milh√µes de reais, o que corresponde a um aumento de cerca de 30%. O munic√≠pio mant√©m ritmo de expans√£o cont√≠nuo, sugerindo planejamento progressivo e previsibilidade fiscal na execu√ß√£o or√ßament√°ria da fun√ß√£o Educa√ß√£o.

üîπ **Moreno**, apesar de apresentar crescimento mais contido (de 54,7 milh√µes de reais para 60,2 milh√µes de reais, cerca de 10%), demonstra maior estabilidade, possivelmente associada a restri√ß√µes de receita ou prioriza√ß√£o de gastos correntes essenciais. Essa tend√™ncia pode indicar limita√ß√£o de investimento em novas a√ß√µes ou depend√™ncia de transfer√™ncias externas.

### Padr√£o Consolidado

De forma agregada, o gr√°fico revela que, embora todos os munic√≠pios ampliem seus gastos educacionais, a intensidade desse crescimento √© desigual, refletindo capacidades fiscais distintas e estrat√©gias diferentes de aloca√ß√£o de recursos.

O destaque de Paudalho sinaliza maior esfor√ßo or√ßament√°rio por habitante, enquanto Moreno mant√©m o menor ritmo de expans√£o, o que pode impactar a capacidade de aprimorar infraestrutura e qualidade do ensino.
"""

# --- Par√¢metros ---
coluna_valor = 'VALORPAGO'
coluna_categoria = 'SUBFUNCAO'
coluna_cidade = 'CIDADE'
funcao_alvo = 'EDUCA√á√ÉO'

# --- 1. Agrega√ß√£o dos dados ---
df_subfuncao = (
    df[df['FUNCAO'] == funcao_alvo]
    .groupby([coluna_cidade, coluna_categoria])[coluna_valor]
    .sum()
    .reset_index()
)

# Converte para milh√µes de reais para melhor escala
df_subfuncao[coluna_valor] = df_subfuncao[coluna_valor] / 1_000_000

# --- 2. Pivot para formato adequado (CIDADE x SUBFUNCAO) ---
df_pivot = df_subfuncao.pivot_table(
    index=coluna_cidade,
    columns=coluna_categoria,
    values=coluna_valor,
    fill_value=0
)

# --- 3. Plotagem ---
cores = sns.color_palette("Spectral", n_colors=len(df_pivot.columns))

ax = df_pivot.plot(
    kind='bar',
    stacked=True,
    figsize=(12, 6),
    color=cores,
    alpha=0.9,
    edgecolor='none'
)

# --- 4. Formata√ß√£o e t√≠tulos ---
plt.title('Distribui√ß√£o do Gasto em Educa√ß√£o por Subfun√ß√£o e Cidade (2022‚Äì2024)', fontsize=15, weight='bold', pad=15)
plt.xlabel('Cidade', fontsize=12)
plt.ylabel('Valor Pago Total (em Milh√µes de R$)', fontsize=12)
plt.legend(title='Subfun√ß√£o', bbox_to_anchor=(1.02, 1), loc='upper left', fontsize=9)
plt.grid(axis='y', linestyle='--', alpha=0.4)

# Formata eixo Y em R$ Milh√µes
ax.yaxis.set_major_formatter(mtick.FuncFormatter(lambda x, _: f'R$ {x:,.1f}M'))

# --- 5. R√≥tulos de valor total por cidade ---
totais = df_pivot.sum(axis=1)
for i, total in enumerate(totais):
    ax.text(i, total + 5, f"R$ {total:.1f}M", ha='center', va='bottom', fontsize=10, fontweight='bold', color='black')

plt.tight_layout()
plt.show()

"""## Insight ‚Äî Estrutura do Gasto Educacional por Subfun√ß√£o (2022‚Äì2024)

A distribui√ß√£o consolidada dos gastos em Educa√ß√£o entre os munic√≠pios de Limoeiro, Moreno e Paudalho revela uma estrutura or√ßament√°ria fortemente concentrada na subfun√ß√£o **Ensino Fundamental**, que representa mais de 70% do total pago em todos os casos. Essa predomin√¢ncia indica o car√°ter estruturalmente r√≠gido da despesa educacional, com foco majorit√°rio em manuten√ß√£o do ensino b√°sico e folha de pessoal.

### An√°lise por Munic√≠pio

üîπ **Paudalho** lidera em volume absoluto, com aproximadamente R$ 232,9 milh√µes, resultado de uma expans√£o significativa nas subfun√ß√µes Educa√ß√£o Infantil e Ensino Fundamental. Esse comportamento sugere maior intensidade de investimento e crescimento da rede p√∫blica, tanto em infraestrutura quanto em amplia√ß√£o de vagas.

üîπ **Limoeiro**, com cerca de R$ 189,1 milh√µes, apresenta uma distribui√ß√£o mais equilibrada, embora ainda concentrada no ensino fundamental. Nota-se leve aumento nas subfun√ß√µes Educa√ß√£o Infantil e Alimenta√ß√£o e Nutri√ß√£o, o que pode indicar refor√ßo em pol√≠ticas de apoio pedag√≥gico e de inclus√£o escolar.

üîπ **Moreno**, por sua vez, exibe o menor volume consolidado (R$ 177,0 milh√µes) e menor diversifica√ß√£o funcional, com gastos majoritariamente vinculados √† manuten√ß√£o do ensino regular. O peso reduzido das subfun√ß√µes complementares sugere restri√ß√µes or√ßament√°rias ou foco em custeio administrativo.

### Padr√£o Consolidado

De modo geral, o gr√°fico evidencia que o perfil de gasto educacional dos tr√™s munic√≠pios permanece altamente concentrado, com baixa varia√ß√£o funcional entre localidades. Essa homogeneidade reflete a depend√™ncia dos or√ßamentos municipais em despesas obrigat√≥rias de pessoal e encargos, reduzindo o espa√ßo fiscal para a√ß√µes estruturantes e inova√ß√£o pedag√≥gica.
"""

# --- Par√¢metros ---
coluna_valor = 'VALORPAGO'
colunas_agrupamento = ['CIDADE', 'ANOREFERENCIA', 'SUBFUNCAO']
funcao_alvo = 'EDUCA√á√ÉO'

# --- 1. Agrega√ß√£o dos dados ---
df_subfuncao_cidade = (
    df[df['FUNCAO'] == funcao_alvo]
    .groupby(colunas_agrupamento)[coluna_valor]
    .sum()
    .reset_index()
)

# Converte para milh√µes de reais
df_subfuncao_cidade[coluna_valor] = df_subfuncao_cidade[coluna_valor] / 1_000_000

# --- 2. Seleciona as Top 3 Subfun√ß√µes Globais ---
top3_subfuncoes = (
    df_subfuncao_cidade.groupby('SUBFUNCAO')[coluna_valor]
    .sum()
    .sort_values(ascending=False)
    .head(3)
    .index
)

df_top3 = df_subfuncao_cidade[df_subfuncao_cidade['SUBFUNCAO'].isin(top3_subfuncoes)]

# --- 3. Cria√ß√£o do FacetGrid (um painel por cidade) ---
g = sns.FacetGrid(
    df_top3,
    col='CIDADE',
    hue='SUBFUNCAO',
    col_wrap=3,
    height=4,
    aspect=1.3,
    palette=['#3055a0', '#fab331', '#bc4a49']
)

# --- 4. Desenha as linhas e pontos ---
g.map(sns.lineplot, 'ANOREFERENCIA', coluna_valor, marker='o', linewidth=2.2)
g.map(sns.scatterplot, 'ANOREFERENCIA', coluna_valor, s=80, edgecolor='black', linewidth=0.5)

# --- 5. Adiciona r√≥tulos de valor em cada ponto ---
for ax, (cidade, df_sub) in zip(g.axes.flatten(), df_top3.groupby('CIDADE')):
    for _, row in df_sub.iterrows():
        ax.text(
            row['ANOREFERENCIA'], row[coluna_valor] + 0.5,
            f"R$ {row[coluna_valor]:.1f}M",
            ha='center', va='bottom',
            fontsize=8.5, color='black', fontweight='bold'
        )

# --- 6. Formata√ß√£o dos eixos e layout ---
for ax in g.axes.flatten():
    ax.yaxis.set_major_formatter(mtick.FuncFormatter(lambda x, _: f'R$ {x:,.1f}M'))
    ax.grid(axis='y', linestyle='--', alpha=0.4)
    ax.set_xlabel('Ano de Refer√™ncia')
    ax.set_ylabel('Valor Pago (em Milh√µes de R$)')

# --- 7. Ajustes globais ---
g.add_legend(title='Subfun√ß√£o', fontsize=9)
plt.subplots_adjust(top=0.88)
g.fig.suptitle(
    'Evolu√ß√£o dos Gastos em Educa√ß√£o ‚Äî Top 3 Subfun√ß√µes por Cidade (2022‚Äì2024)',
    fontsize=15, fontweight='bold'
)
plt.show()

"""## Insight ‚Äî Estrutura e Din√¢mica do Gasto Educacional (2022‚Äì2024)

A an√°lise integrada das subfun√ß√µes e dos principais fornecedores da fun√ß√£o Educa√ß√£o revela um quadro de alta concentra√ß√£o em despesas de pessoal e manuten√ß√£o de ensino, com crescimento cont√≠nuo do gasto total e diferencia√ß√£o significativa entre os munic√≠pios quanto √† composi√ß√£o e prioridade or√ßament√°ria.

O gr√°fico evidencia que, em todos os munic√≠pios analisados, a subfun√ß√£o **‚ÄúEnsino Fundamental‚Äù domina amplamente a execu√ß√£o or√ßament√°ria**, representando o n√∫cleo central do gasto educacional ‚Äî variando entre 46 milh√µes de reais e 74 milh√µes de reais no per√≠odo de 2022 a 2024. Essa trajet√≥ria ascendente reflete a rigidez estrutural do custeio educacional, associada principalmente √† folha de pagamento e encargos previdenci√°rios.

### An√°lise por Munic√≠pio

üîπ **Paudalho** apresenta o maior volume absoluto e crescimento mais acentuado, atingindo cerca de 74,8 milh√µes de reais em 2024, o que indica expans√£o de programas e poss√≠vel amplia√ß√£o do quadro funcional da rede municipal. O destaque para ‚ÄúEduca√ß√£o Infantil‚Äù ‚Äî com salto de 6,8 milh√µes de reais para 11,9 milh√µes de reais ‚Äî refor√ßa um movimento de investimento na base da educa√ß√£o.

üîπ **Moreno** mant√©m um perfil de crescimento mais est√°vel, com valores entre 51 milh√µes de reais e 59 milh√µes de reais no Ensino Fundamental. Entretanto, as subfun√ß√µes ‚ÄúEduca√ß√£o Infantil‚Äù e ‚ÄúAlimenta√ß√£o e Nutri√ß√£o‚Äù permanecem quase estagnadas, sugerindo baixa diversifica√ß√£o das pol√≠ticas educacionais ou forte depend√™ncia de programas federais.

üîπ **Limoeiro**, embora parta de valores menores, revela crescimento cont√≠nuo e uma recomposi√ß√£o gradual da estrutura de gasto, com destaque para a ‚ÄúEduca√ß√£o Infantil‚Äù e a ‚ÄúAlimenta√ß√£o Escolar‚Äù, ambas em trajet√≥ria ascendente. Essa tend√™ncia sugere maior equil√≠brio entre custeio e apoio pedag√≥gico, ainda que o foco principal continue sendo o ensino b√°sico.

### Padr√£o Estrutural Consolidado

De forma consolidada, os tr√™s munic√≠pios compartilham um mesmo padr√£o estrutural:

* Predomin√¢ncia da subfun√ß√£o **Ensino Fundamental** como eixo central do or√ßamento;
* Baixa participa√ß√£o das subfun√ß√µes complementares (alimenta√ß√£o e educa√ß√£o infantil);
* Crescimento nominal expressivo, mas com **concentra√ß√£o em despesas obrigat√≥rias**.

Esse comportamento indica baixo grau de flexibilidade or√ßament√°ria e refor√ßa a import√¢ncia de aperfei√ßoar a governan√ßa do gasto educacional, de modo a equilibrar a execu√ß√£o entre manuten√ß√£o, infraestrutura e inova√ß√£o pedag√≥gica ‚Äî elementos essenciais para a melhoria da qualidade do ensino e a efici√™ncia do investimento p√∫blico.
"""

# --- Par√¢metros ---
coluna_valor = 'VALORPAGO'
colunas_agrupamento = ['CIDADE', 'ANOREFERENCIA', 'FORNECEDOR']
funcao_alvo = 'EDUCA√á√ÉO'

# --- 1. Filtra e agrega os dados ---
df_fornecedores = (
    df[df['FUNCAO'] == funcao_alvo]
    .groupby(colunas_agrupamento)[coluna_valor]
    .sum()
    .reset_index()
)

# Converte para milh√µes de reais
df_fornecedores[coluna_valor] = df_fornecedores[coluna_valor] / 1_000_000

# --- 2. Seleciona Top 5 fornecedores por cidade e ano ---
df_top5 = (
    df_fornecedores
    .sort_values(['CIDADE', 'ANOREFERENCIA', coluna_valor], ascending=[True, True, False])
    .groupby(['CIDADE', 'ANOREFERENCIA'])
    .head(5)
    .reset_index(drop=True)
)

# --- 3. Exibi√ß√£o estruturada por cidade e ano ---
print("===== TOP 5 FORNECEDORES POR CIDADE E ANO (EM MILH√ïES DE R$) =====")
for (cidade, ano), grupo in df_top5.groupby(['CIDADE', 'ANOREFERENCIA']):
    print(f"\nüìç {cidade} ‚Äî {ano}")
    display(
        grupo[['FORNECEDOR', coluna_valor]]
        .rename(columns={'FORNECEDOR': 'Fornecedor', coluna_valor: 'Valor Pago (R$ Milh√µes)'})
        .style.format({'Valor Pago (R$ Milh√µes)': 'R$ {:.2f}M'})
    )

# --- 4. (Opcional) Visualiza√ß√£o gr√°fica resumida ---
plt.figure(figsize=(10, 6))
sns.barplot(
    data=df_top5,
    x=coluna_valor,
    y='FORNECEDOR',
    hue='CIDADE',
    orient='h',
    palette=['#3055a0', '#fab331', '#bc4a49']
)

plt.title('Top 5 Fornecedores em Educa√ß√£o (2022‚Äì2024)', fontsize=15, weight='bold')
plt.xlabel('Valor Pago (Milh√µes de R$)', fontsize=11)
plt.ylabel('Fornecedor', fontsize=11)
plt.legend(title='Cidade')
plt.grid(axis='x', linestyle='--', alpha=0.4)
plt.tight_layout()
plt.show()

"""##Insight ‚Äî Concentra√ß√£o e Padr√µes de Fornecimento na Fun√ß√£o Educa√ß√£o (2022‚Äì2024)

A an√°lise dos Top 5 fornecedores por cidade e ano evidencia um forte padr√£o de concentra√ß√£o or√ßament√°ria em torno da Folha de Pagamento e de √≥rg√£os previdenci√°rios e educacionais municipais, refor√ßando o peso estrutural das despesas de pessoal e encargos na fun√ß√£o Educa√ß√£o.

Em todos os munic√≠pios, a Folha de Pagamento ocupa a lideran√ßa absoluta dos gastos, representando a principal destina√ß√£o or√ßament√°ria da educa√ß√£o ‚Äî variando de cerca de R$ 30 a 48 milh√µes anuais, o que reflete a alta rigidez das despesas de custeio e o baixo espa√ßo fiscal para investimentos diretos em infraestrutura ou inova√ß√£o pedag√≥gica.

üîπ Limoeiro demonstra um padr√£o de gasto crescente, com destaque para a Faculdade de Ci√™ncias da Administra√ß√£o e prestadores de servi√ßos de apoio (como D. Feitosa Aluguel de M√°quinas e Construtora Pilartex). H√° ind√≠cios de diversifica√ß√£o de fornecedores ao longo dos anos, embora o componente de folha continue predominante.

üîπ Moreno apresenta maior continuidade contratual, com fornecedores recorrentes como SOLSERV Servi√ßos Ltda. e Prime Consultoria e Assessoria Empresarial Ltda., al√©m de expressiva participa√ß√£o da Folha de Pagamento, que supera R$ 40 milh√µes por ano. Essa estabilidade pode indicar contratos plurianuais ou terceiriza√ß√£o de servi√ßos continuados.

üîπ Paudalho, por sua vez, exibe forte correla√ß√£o entre o Fundo Municipal de Educa√ß√£o e fornecedores locais (como Octagon Empreendimentos Ltda. e Jos√© Luiz F√©lix Cabral J√∫nior ME). A amplia√ß√£o expressiva dos repasses ao Fundo Municipal de Educa√ß√£o em 2024 (R$ 17,1 milh√µes) sugere expans√£o de programas ou reestrutura√ß√£o financeira interna.

De forma geral, o per√≠odo 2022‚Äì2024 confirma um cen√°rio de centraliza√ß√£o das despesas educacionais em compromissos obrigat√≥rios de pessoal, com menor representatividade de contratos de natureza operacional ou inovadora. Essa configura√ß√£o refor√ßa a necessidade de an√°lises complementares sobre a efici√™ncia do gasto corrente e a depend√™ncia de fornecedores estrat√©gicos, elementos centrais para a governan√ßa e o planejamento de m√©dio prazo.

# **Separa√ß√£o limpeza 2**
"""

for i, col in enumerate(df.columns):
    print(i, col)

[x for x in df['ACAO'].unique() if "ÔøΩ" in str(x) or "?" in str(x)]

mapa_de_correcao_acao = {
    'ALFABETIZAÔøΩÔøΩO DE JOVENS E ADULTOS 70%': 'ALFABETIZA√á√ÉO DE JOVENS E ADULTOS 70%',
    'AMORTIZAÔøΩÔøΩO DA DÔøΩVIDA': 'AMORTIZA√á√ÉO DA D√çVIDA',
    'AMPLIAÔøΩÔøΩO E RESTAURAÔøΩÔøΩO DO PRÔøΩDIO DA FACAL': 'AMPLIA√á√ÉO E RESTAURA√á√ÉO DO PR√âDIO DA FACAL',
    'Aquisi??o de fardamento para estudantes': 'AQUISI√á√ÉO DE FARDAMENTO PARA ESTUDANTES',
    'AquisiÔøΩÔøΩo de fardamento para estudantes': 'AQUISI√á√ÉO DE FARDAMENTO PARA ESTUDANTES',
    'AQUISIÔøΩÔøΩO DE TRANSPORTE ESCOLAR': 'AQUISI√á√ÉO DE TRANSPORTE ESCOLAR',
    'AquisiÔøΩÔøΩo de veÔøΩculos destinados ao transporte de estudantes.': 'AQUISI√á√ÉO DE VE√çCULOS DESTINADOS AO TRANSPORTE DE ESTUDANTES',
    'Construir ampliar e equipar a??es do PAR - Plano de A??es Articuladas': 'CONSTRUIR, AMPLIAR E EQUIPAR A√á√ïES DO PAR - PLANO DE A√á√ïES ARTICULADAS',
    'CONSTRUÔøΩÔøΩO AMPLIAÔøΩÔøΩO E REFORMAS DE CRECHE': 'CONSTRU√á√ÉO, AMPLIA√á√ÉO E REFORMAS DE CRECHE',
    'CONSTRUÔøΩÔøΩO AMPLIAÔøΩÔøΩO E RESTAURAÔøΩÔøΩO DE UNIDADES ESCOLARES E QUADRAS PO': 'CONSTRU√á√ÉO, AMPLIA√á√ÉO E RESTAURA√á√ÉO DE UNIDADES ESCOLARES E QUADRAS POLIESPORTIVAS',
    'ConstruÔøΩÔøΩo e/ou recuperaÔøΩÔøΩo de creches e escolas e aquisiÔøΩÔøΩo de mobili': 'CONSTRU√á√ÉO E/OU RECUPERA√á√ÉO DE CRECHES E ESCOLAS E AQUISI√á√ÉO DE MOBILI√ÅRIO',
    'CONTRIBUIÔøΩÔøΩES PREVIDÔøΩNCIÔøΩRIAS E FGTS': 'CONTRIBUI√á√ïES PREVIDENCI√ÅRIAS E FGTS',
    'CONTRIBUIÔøΩÔøΩO PARA O PASEP': 'CONTRIBUI√á√ÉO PARA O PASEP',
    'DESAPROPRIAÔøΩÔøΩO': 'DESAPROPRIA√á√ÉO',
    'DesapropriaÔøΩÔøΩo de ImÔøΩveis para EducaÔøΩÔøΩo do MunicÔøΩpio': 'DESAPROPRIA√á√ÉO DE IM√ìVEIS PARA EDUCA√á√ÉO DO MUNIC√çPIO',
    'Educa??o de Jovens e Adultos': 'EDUCA√á√ÉO DE JOVENS E ADULTOS',
    'EducaÔøΩÔøΩo de Jovens e Adultos': 'EDUCA√á√ÉO DE JOVENS E ADULTOS',
    'Gest?o Administrativa da Educa??o Municipal': 'GEST√ÉO ADMINISTRATIVA DA EDUCA√á√ÉO MUNICIPAL',
    'GestÔøΩo Administrativa da EducaÔøΩÔøΩo Municipal': 'GEST√ÉO ADMINISTRATIVA DA EDUCA√á√ÉO MUNICIPAL',
    'GESTÔøΩO TÔøΩCNICA E ADMINISTRATIVA DA FACAL': 'GEST√ÉO T√âCNICA E ADMINISTRATIVA DA FACAL',
    'GESTÔøΩO TÔøΩCNICA E ADMINISTRATIVA DA SECRETARIA': 'GEST√ÉO T√âCNICA E ADMINISTRATIVA DA SECRETARIA',
    'Manuten??o do Ensino Fundamental': 'MANUTEN√á√ÉO DO ENSINO FUNDAMENTAL',
    'Manuten??o do Ensino Infantil': 'MANUTEN√á√ÉO DO ENSINO INFANTIL',
    'MANUTENÔøΩÔøΩO APOIADORES DA EDUCAÔøΩÔøΩO': 'MANUTEN√á√ÉO APOIADORES DA EDUCA√á√ÉO',
    'MANUTENÔøΩÔøΩO DA BIBLIOTECA': 'MANUTEN√á√ÉO DA BIBLIOTECA',
    'MANUTENÔøΩÔøΩO DA EDUCAÔøΩÔøΩO INFANTIL': 'MANUTEN√á√ÉO DA EDUCA√á√ÉO INFANTIL',
    'MANUTENÔøΩÔøΩO DA EDUCAÔøΩÔøΩO INFANTIL - NOVAS TURMAS': 'MANUTEN√á√ÉO DA EDUCA√á√ÉO INFANTIL - NOVAS TURMAS',
    'MANUTENÔøΩÔøΩO DA EDUCAÔøΩÔøΩO INFANTIL 70%': 'MANUTEN√á√ÉO DA EDUCA√á√ÉO INFANTIL 70%',
    'MANUTENÔøΩÔøΩO DO ENSINO FUNDAMENTAL': 'MANUTEN√á√ÉO DO ENSINO FUNDAMENTAL',
    'MANUTENÔøΩÔøΩO DO ENSINO FUNDAMENTAL 30%': 'MANUTEN√á√ÉO DO ENSINO FUNDAMENTAL 30%',
    'MANUTENÔøΩÔøΩO DO ENSINO FUNDAMENTAL 70%': 'MANUTEN√á√ÉO DO ENSINO FUNDAMENTAL 70%',
    'MANUTENÔøΩÔøΩO DO ENSINO FUNDAMENTAL/SALÔøΩRIO EDUCAÔøΩÔøΩO': 'MANUTEN√á√ÉO DO ENSINO FUNDAMENTAL / SAL√ÅRIO EDUCA√á√ÉO',
    'ManutenÔøΩÔøΩo do Ensino Infantil': 'MANUTEN√á√ÉO DO ENSINO INFANTIL',
    'MANUTENÔøΩÔøΩO DO ENSINO SUPERIOR': 'MANUTEN√á√ÉO DO ENSINO SUPERIOR',
    'MANUTENÔøΩÔøΩO DO TRANSPORTE ESCOLAR': 'MANUTEN√á√ÉO DO TRANSPORTE ESCOLAR',
    'MANUTENÔøΩÔøΩO DO TRANSPORTE ESCOLAR 30%': 'MANUTEN√á√ÉO DO TRANSPORTE ESCOLAR 30%',
    'Oferecer servi?o de transporte aos estudantes univesit?rios morenenses': 'OFERECER SERVI√áO DE TRANSPORTE AOS ESTUDANTES UNIVERSIT√ÅRIOS MORENENSES',
    'Oferecer servi?o de transporte escolar regular para os alunos de escol': 'OFERECER SERVI√áO DE TRANSPORTE ESCOLAR REGULAR PARA OS ALUNOS DE ESCOLAS MUNICIPAIS',
    'Oferecer serviÔøΩo de transporte aos estudantes universitÔøΩrios morenense': 'OFERECER SERVI√áO DE TRANSPORTE AOS ESTUDANTES UNIVERSIT√ÅRIOS MORENENSES',
    'Oferecer serviÔøΩo de transporte escolar regular para os alunos de escol': 'OFERECER SERVI√áO DE TRANSPORTE ESCOLAR REGULAR PARA OS ALUNOS DE ESCOLAS MUNICIPAIS',
    'PROGRAMA DE ALIMENTAÔøΩÔøΩO ESCOLAR': 'PROGRAMA DE ALIMENTA√á√ÉO ESCOLAR',
    'REEQUIPAMENTO DA EDUCAÔøΩÔøΩO INFANTIL': 'REEQUIPAMENTO DA EDUCA√á√ÉO INFANTIL',
    'REEQUIPAMENTO DO ENSINO FUNDAMENTAL E AQUISAÔøΩÔøΩO DE VEÔøΩCULOS': 'REEQUIPAMENTO DO ENSINO FUNDAMENTAL E AQUISI√á√ÉO DE VE√çCULOS',
    'REEQUIPAMENTO DO ENSINO FUNDAMENTAL E AQUISIÔøΩÔøΩO DE VEÔøΩCULOS': 'REEQUIPAMENTO DO ENSINO FUNDAMENTAL E AQUISI√á√ÉO DE VE√çCULOS'
}


df['ACAO'] = df['ACAO'].replace(mapa_de_correcao_acao)

df['ACAO'].unique()

df['FORNECEDOR'].unique()

mapa_fornecedor = {
    'Folha de Pagamento (Fornecedor PadrÔøΩo)': 'FOLHA DE PAGAMENTO (FORNECEDOR PADR√ÉO)',
    'VENEZA DIESEL CAMINHÔøΩES ÔøΩNIBUS LTDA': 'VENEZA DIESEL CAMINH√ïES √îNIBUS LTDA',
    'FNDE - FUNDO NACIONAL DE DESENVOLVIMENTO DA EDUCAÔøΩÔøΩO': 'FNDE - FUNDO NACIONAL DE DESENVOLVIMENTO DA EDUCA√á√ÉO',
    'ASSOCIAÔøΩÔøΩO PEQUENOS PRODUTORES RURAIS ENGENHO JUSSARA': 'ASSOCIA√á√ÉO PEQUENOS PRODUTORES RURAIS ENGENHO JUSSARA',
    'BONANÔøΩA PRODUTOS ALIMENTÔøΩCIOS E CESTAS BÔøΩSICAS EIRELI - EPP': 'BONAN√áA PRODUTOS ALIMENT√çCIOS E CESTAS B√ÅSICAS EIRELI - EPP',
    'ASSOCIA??O PEQUENOS PRODUTORES RURAIS ENGENHO JUSSARA': 'ASSOCIA√á√ÉO PEQUENOS PRODUTORES RURAIS ENGENHO JUSSARA',
    'CJ CONSTRUÔøΩÔøΩES E EMPREENDIMENTOS EIRELI EPP': 'CJ CONSTRU√á√ïES E EMPREENDIMENTOS EIRELI EPP',
    'GMAQ ALUGUEL DE MÔøΩQUINAS E SERVIÔøΩOS LTDA': 'GMAQ ALUGUEL DE M√ÅQUINAS E SERVI√áOS LTDA',
    'RÔøΩMULO LUIZ SANTANA DA SILVA ( J. NETO PRODUTOS   SERVIÔøΩOS)': 'R√îMULO LUIZ SANTANA DA SILVA ( J. NETO PRODUTOS   SERVI√áOS)',
    'THS CONSTRUTORA E INCORPORAÔøΩÔøΩO LTDA - ME': 'THS CONSTRUTORA E INCORPORA√á√ÉO LTDA - ME',
    'TRIBUNAL DE JUSTIÔøΩA DO ESTADO DE PERNAMBUCO': 'TRIBUNAL DE JUSTI√áA DO ESTADO DE PERNAMBUCO',
    'FERNANDO JOSÔøΩ DA SILVA': 'FERNANDO JOS√â DA SILVA',
    'LUCIANE MARIA ANT?O DOS SANTOS81978600410': 'LUCIANE MARIA ANT√ÉO DOS SANTOS 81978600410',
    'JOABE LOPES DE FRAN?A': 'JOABE LOPES DE FRAN√áA',
    'JAERSON LOPES DE FRAN?A': 'JAERSON LOPES DE FRAN√áA',
    'CONS?RCIO DE TRANSP. DA REGI?O METROP. DO RECIFE LTDA': 'CONS√ìRCIO DE TRANSP. DA REGI√ÉO METROP. DO RECIFE LTDA',
    'COMPANHIA ENERG?TICA DE PERNAMBUCO - CELPE': 'COMPANHIA ENERG√âTICA DE PERNAMBUCO - CELPE',
    'CENTRO DE INTEGRA??O EMPRESA ESCOLA DE PERNAMBUCO - CIEE': 'CENTRO DE INTEGRA√á√ÉO EMPRESA ESCOLA DE PERNAMBUCO - CIEE',
    'BONAN?A GAS EIRELI': 'BONAN√áA G√ÅS EIRELI',
    'JOSEVALTER JOSÔøΩ DE FRANÔøΩA': 'JOSEVALTER JOS√â DE FRAN√áA',
    'UBERLÔøΩNDIA SILVA DE SOUZA': 'UBERL√ÇNDIA SILVA DE SOUZA',
    'MARIA JOSÔøΩ NUNES VIEIRA': 'MARIA JOS√â NUNES VIEIRA',
    'SEVERINO LORENÔøΩO DA SILVA': 'SEVERINO LOREN√áO DA SILVA',
    'ANA CAROLINE ARAÔøΩJO CAMPOS': 'ANA CAROLINE ARA√öJO CAMPOS',
    'ANALÔøΩCIA FERREIRA DE MOURA BRAZ': 'ANAL√çCIA FERREIRA DE MOURA BRAZ',
    'MARIA LÔøΩCIA DA SILVA': 'MARIA L√öCIA DA SILVA',
    'JOSE BARBOSA ANDRÔøΩ': 'JOSE BARBOSA ANDR√â',
    'JOSÔøΩ AUGUSTO DIAS DA SILVA': 'JOS√â AUGUSTO DIAS DA SILVA',
    'CAIXA ECONÔøΩMICA FEDERAL': 'CAIXA ECON√îMICA FEDERAL',
    'FUNDO NACIONAL DE DESENVOLVIMENTO DA EDUCAÔøΩÔøΩO': 'FUNDO NACIONAL DE DESENVOLVIMENTO DA EDUCA√á√ÉO',
    'TELEFÔøΩNICA BRASIL S.A.': 'TELEF√îNICA BRASIL S.A.',
    'SERVIÔøΩO NACIONAL DE APRENDIZAGEM COMERCIAL - SENAC': 'SERVI√áO NACIONAL DE APRENDIZAGEM COMERCIAL - SENAC',
    'ESFERA PRESTAÔøΩÔøΩO DE SERVIÔøΩOS E COMÔøΩRCIO LTDA': 'ESFERA PRESTA√á√ÉO DE SERVI√áOS E COM√âRCIO LTDA',
    'DAGEAL - COMÔøΩRCIO DE MATERIAL DE ESCRITORIO LTDA': 'DAGEAL - COM√âRCIO DE MATERIAL DE ESCRIT√ìRIO LTDA',
    'MJ COMERCIO DE MÔøΩVEIS EIRELI': 'MJ COMERCIO DE M√ìVEIS EIRELI',
    'CONSÔøΩRCIO DE TRANSP. DA REGIÔøΩO METROP. DO RECIFE LTDA': 'CONS√ìRCIO DE TRANSP. DA REGI√ÉO METROP. DO RECIFE LTDA',
    'JR-PARTNER INFORMÔøΩTICA LOCAÔøΩÔøΩO E EVENTOS LTDA - ME': 'JR-PARTNER INFORM√ÅTICA LOCA√á√ÉO E EVENTOS LTDA - ME',
    'COMPANHIA ENERGÔøΩTICA DE PERNAMBUCO - CELPE': 'COMPANHIA ENERG√âTICA DE PERNAMBUCO - CELPE',
    'CENTRO DE INTEGRAÔøΩÔøΩO EMPRESA ESCOLA DE PERNAMBUCO - CIEE': 'CENTRO DE INTEGRA√á√ÉO EMPRESA ESCOLA DE PERNAMBUCO - CIEE',
    'CIDADE EVANGELICA DOS ORFÔøΩOS': 'CIDADE EVANG√âLICA DOS √ìRF√ÉOS',
    'PONTESTUR AGÔøΩNCIA DE VIAGENS E TURISMO LTDA': 'PONTESTUR AG√äNCIA DE VIAGENS E TURISMO LTDA',
    '1 TELECOM SERVIÔøΩOS DE TECNOLOGIA EM INTERNET LTDA': '1 TELECOM SERVI√áOS DE TECNOLOGIA EM INTERNET LTDA',
    'UNDIME- UNIÔøΩO NACIONAL DOS DIRIGENTES MUNICIPAIS DE EDUCA': 'UNDIME- UNI√ÉO NACIONAL DOS DIRIGENTES MUNICIPAIS DE EDUCA√á√ÉO',
    'MP3 DISTRIBUIÔøΩÔøΩO E IMPORTAÔøΩÔøΩO DE UTILIDADES E MATERIAL ESCOLAR EIRELI - EPP': 'MP3 DISTRIBUI√á√ÉO E IMPORTA√á√ÉO DE UTILIDADES E MATERIAL ESCOLAR EIRELI - EPP',
    'UNIÔøΩO NACIONAL DOS CONSELHOS MUNICIPAIS DE EDUCAÔøΩÔøΩO': 'UNI√ÉO NACIONAL DOS CONSELHOS MUNICIPAIS DE EDUCA√á√ÉO',
    'BONANÔøΩA GAS EIRELI': 'BONAN√áA G√ÅS EIRELI',
    'P. MESQUITA NETO DISTRIBUIÔøΩÔøΩO DE ÔøΩGUA': 'P. MESQUITA NETO DISTRIBUI√á√ÉO DE √ÅGUA',
    'CONSULT SAÔøΩDE AMBIENTAL LTDA': 'CONSULT SA√öDE AMBIENTAL LTDA',
    'PESSOAL CIVIL SECRETARIA MUNICIPAL DE EDUCAÔøΩÔøΩO': 'PESSOAL CIVIL SECRETARIA MUNICIPAL DE EDUCA√á√ÉO',
    'TRIBUNAL DE JUSTIÔøΩA DE PERNAMBUCO': 'TRIBUNAL DE JUSTI√áA DE PERNAMBUCO',
    'SYSTEMA INFORMATICA COMERCIO E SERVIÔøΩOS LTDA': 'SYSTEMA INFORM√ÅTICA COM√âRCIO E SERVI√áOS LTDA',
    'CELPE - COMPANHIA ENERGÔøΩTICA DE PERNAMBUCO': 'CELPE - COMPANHIA ENERG√âTICA DE PERNAMBUCO',
    'JOSÔøΩ CARLOS DA SILVA CHAVEIRO - ME': 'JOS√â CARLOS DA SILVA CHAVEIRO - ME',
    'VCOATSS COMÔøΩRCIO DE GÔøΩS E ÔøΩGUA EIRELI': 'VCOATSS COM√âRCIO DE G√ÅS E √ÅGUA EIRELI',
    'LUÔøΩS HENRIQUE A. DE MELO E SILVA - ME': 'LU√çS HENRIQUE A. DE MELO E SILVA - ME',
    'AR 19 CERTIFICAÔøΩÔøΩO DIGITAL SERVIÔøΩOS LTDA': 'AR 19 CERTIFICA√á√ÉO DIGITAL SERVI√áOS LTDA',
    'ASSOCIAÔøΩÔøΩO COMERCIAL E INDUSTRIAL DO LIMOEIRO': 'ASSOCIA√á√ÉO COMERCIAL E INDUSTRIAL DO LIMOEIRO',
    'LIMOPREV - FUNDO PREVIDENCIÔøΩRIO DO MUNICÔøΩPIO DE LIMOEIRO': 'LIMOPREV - FUNDO PREVIDENCI√ÅRIO DO MUNIC√çPIO DE LIMOEIRO',
    'EDVÔøΩNIA SABINO DE OLIVEIRA LUNA': 'EDV√ÇNIA SABINO DE OLIVEIRA LUNA',
    'FÔøΩBIA TACIANA CÔøΩNDIDA MARINHO': 'F√ÅBIA TACIANA C√ÇNDIDA MARINHO',
    'SELMA MARIA DE ARRUDA FRANÔøΩA': 'SELMA MARIA DE ARRUDA FRAN√áA',
    'JOÔøΩO GOMES DA SILVA': 'JO√ÉO GOMES DA SILVA',
    'ADAUTO ANTÔøΩNIO DE SOUSA FILHO': 'ADAUTO ANT√îNIO DE SOUSA FILHO',
    'MARIA AUXILIADORA ALVES ARAGÔøΩO': 'MARIA AUXILIADORA ALVES ARAG√ÉO',
    'TAMIRIS DA CONCEIÔøΩÔøΩO DA SILVA': 'TAMIRIS DA CONCEI√á√ÉO DA SILVA',
    'JOSÔøΩ ABEL CRISTOVÔøΩO DOS SANTOS': 'JOS√â ABEL CRIST√ìV√ÉO DOS SANTOS',
    'JOSÔøΩ ERNANDES DE OLIVEIRA ARAGÔøΩO': 'JOS√â ERNANDES DE OLIVEIRA ARAG√ÉO',
    'JOSÔøΩ IVALDO DE ALBUQUERQUE CAVALCANTI': 'JOS√â IVALDO DE ALBUQUERQUE CAVALCANTI',
    'MARIA LÔøΩCIA DE ALBUQUERQUE RODRIGUES': 'MARIA L√öCIA DE ALBUQUERQUE RODRIGUES',
    'DIORGENES JOSÔøΩ DA SILVA': 'DIORGENES JOS√â DA SILVA',
    'SAUL JOSÔøΩ DE LUNA': 'SAUL JOS√â DE LUNA',
    'KELLY KRISTINE CORREIA DE ARAÔøΩJO': 'KELLY KRISTINE CORREIA DE ARA√öJO',
    'MARIA BETÔøΩNIA DA SILVA': 'MARIA BET√ÇNIA DA SILVA',
    'SOCORRO EUFRÔøΩSIO DANTAS MENDES': 'SOCORRO EUFR√ÅSIO DANTAS MENDES',
    'LUIS GONÔøΩALVES DO NASCIMENTO': 'LUIS GON√áALVES DO NASCIMENTO',
    'JOSEFA MARIA DA CONCEIÔøΩÔøΩO': 'JOSEFA MARIA DA CONCEI√á√ÉO',
    'JOSÔøΩ FERNANDO DE MELO': 'JOS√â FERNANDO DE MELO',
    'JOSÔøΩ FABIANO DE MELO SILVINO': 'JOS√â FABIANO DE MELO SILVINO',
    'SEBASTIÔøΩO DE ABREU SILVA': 'SEBASTI√ÉO DE ABREU SILVA',
    'GERNAN DO REGO BIONE JÔøΩNIOR': 'GERNAN DO REGO BIONE J√öNIOR',
    'ANTÔøΩNIO SOARES CORREIA DE AZEVEDO': 'ANT√îNIO SOARES CORREIA DE AZEVEDO',
    'DANIELE MARIA FERREIRA LOURENÔøΩO DE ARAÔøΩJO': 'DANIELE MARIA FERREIRA LOUREN√áO DE ARA√öJO',
    'MÔøΩNICA MARIA DE LUCENA NEGROMONTE ROCHA': 'M√îNICA MARIA DE LUCENA NEGROMONTE ROCHA',
    'JOSÔøΩ FÔøΩBIO CORREIA DE MELO': 'JOS√â F√ÅBIO CORREIA DE MELO',
    'VALQUÔøΩRIA PINTO LEITE': 'VALQU√âRIA PINTO LEITE',
    'FLOR DA MATA COMERCIO EMPREENDIMENTOS E SERVIÔøΩOS EIRELI': 'FLOR DA MATA COMERCIO EMPREENDIMENTOS E SERVI√áOS EIRELI',
    'IAUPE - INSTITUTO DE APOIO A FUNDAÔøΩÔøΩO UNIVERSIDADE DE PERNAMBUCO': 'IAUPE - INSTITUTO DE APOIO A FUNDA√á√ÉO UNIVERSIDADE DE PERNAMBUCO',
    'UNIÔøΩO NACIONAL DOS DIRIGENTES MUNICIPAIS DE EDUCAÔøΩÔøΩO': 'UNI√ÉO NACIONAL DOS DIRIGENTES MUNICIPAIS DE EDUCA√á√ÉO',
    'A. M. DE SOUZA ARAGÔøΩO': 'A. M. DE SOUZA ARAG√ÉO',
    'JAIRTON SILVA OLIVEIRA INFORMÔøΩTICA': 'JAIRTON SILVA OLIVEIRA INFORM√ÅTICA',
    'DAGEAL - COMERCIO DE MATERIAL DE ESCRITÔøΩRIO LTDA': 'DAGEAL - COMERCIO DE MATERIAL DE ESCRIT√ìRIO LTDA',
    'DETRAN - DEPARTAMENTO ESTADUAL DE TRÔøΩNSITO DE PERNAMBUCO': 'DETRAN - DEPARTAMENTO ESTADUAL DE TR√ÇNSITO DE PERNAMBUCO',
    'ASSOCIAÔøΩÔøΩO ATLÔøΩTICA BANCO DO BRASIL': 'ASSOCIA√á√ÉO ATL√âTICA BANCO DO BRASIL',
    'CARTÔøΩRIO 2ÔøΩ OFÔøΩCIO DE REGISTRO DE TÔøΩTULOS E DOCUMENTOS DE REG. CIVIL DE PESSOAS': 'CART√ìRIO 2¬∫ OF√çCIO DE REGISTRO DE T√çTULOS E DOCUMENTOS DE REG. CIVIL DE PESSOAS',
    'DIOCESE DE NAZARÔøΩ': 'DIOCESE DE NAZAR√â',
    'CENTRO DE CRIAÔøΩÔøΩO GALPÔøΩO DAS ARTES': 'CENTRO DE CRIA√á√ÉO GALP√ÉO DAS ARTES',
    'CARTÔøΩRIO DE LIMOEIRO - PE - 2 OFÔøΩCIO': 'CART√ìRIO DE LIMOEIRO - PE - 2 OF√çCIO',
    'ASSOCIAÔøΩÔøΩO FRANCISCANA MARISTELA DO BRASIL': 'ASSOCIA√á√ÉO FRANCISCANA MARISTELA DO BRASIL',
    'FEDERAÔøΩÔøΩO PERNAMBUCANA DE FUTEBOL DE SALÔøΩO': 'FEDERA√á√ÉO PERNAMBUCANA DE FUTEBOL DE SAL√ÉO',
    'UNIÔøΩO DOS DIRIGENTES MUNICIPAIS DE EDUCAÔøΩÔøΩO': 'UNI√ÉO DOS DIRIGENTES MUNICIPAIS DE EDUCA√á√ÉO',
    'VANESSA ALBUQUERQUE GONÔøΩALVES COSTA ME': 'VANESSA ALBUQUERQUE GON√áALVES COSTA ME',
    'JUMEÔøΩS MATERIAL DE CONSTRUÔøΩÔøΩO LTDA': 'JUMES MATERIAL DE CONSTRU√á√ÉO LTDA',
    'JOSÔøΩ SINALDO SOUZA DA SILVA': 'JOS√â SINALDO SOUZA DA SILVA',
    'MORK SOLAR - PRODUTOS E SERVIÔøΩOS ELÔøΩTRICOS LTDA': 'MORK SOLAR - PRODUTOS E SERVI√áOS EL√âTRICOS LTDA',
    'ALIANÔøΩA DISTRIBUIDORA DE MATERIAI EM GERAL LTDA - ME': 'ALIAN√áA DISTRIBUIDORA DE MATERIAIS EM GERAL LTDA - ME',
    'NOÔøΩ DA SILVA MENDONCA 68770472491': 'NO√â DA SILVA MENDON√áA 68770472491',
    'GRAFICPAPER COMÔøΩRCIO E SERVIÔøΩOS EIRELI': 'GRAFICPAPER COM√âRCIO E SERVI√áOS EIRELI',
    'ALBA VALÔøΩRIA ANDRADE SILVA ME': 'ALBA VAL√âRIA ANDRADE SILVA ME',
    'A. R. CONFECÔøΩÔøΩES DE ROUPAS E FARDAMENTOS LTDA': 'A. R. CONFEC√á√ïES DE ROUPAS E FARDAMENTOS LTDA',
    'FUNDO MUNICIPAL DE EDUCAÔøΩÔøΩO - FME': 'FUNDO MUNICIPAL DE EDUCA√á√ÉO - FME',
    'MILKMA COMERCIO E SERVIÔøΩOS LTDA ME': 'MILKMA COMERCIO E SERVI√áOS LTDA ME',
    'SANTOS   SILVA ASSESSORIA PÔøΩBLICA LTDA': 'SANTOS   SILVA ASSESSORIA P√öBLICA LTDA',
    'ÔøΩNICA SANEANTES LTDA': '√öNICA SANEANTES LTDA',
    'IMPERIO EMPREENDIMENTOS COMERCIAIS E SERVIÔøΩOS LTDA': 'IMPERIO EMPREENDIMENTOS COMERCIAIS E SERVI√áOS LTDA',
    'SANDRA VALÔøΩRIA DE ARRUDA SANTOS': 'SANDRA VAL√âRIA DE ARRUDA SANTOS',
    'ÔøΩRICA PATRÔøΩCIA DA SIVLA AMORIM': '√âRICA PATR√çCIA DA SILVA AMORIM',
    'MARIA DA CONCEIÔøΩÔøΩO AMORIM DE AZEVEDO': 'MARIA DA CONCEI√á√ÉO AMORIM DE AZEVEDO',
    'JOSÔøΩ FERNANDO DA SILVA ALVES': 'JOS√â FERNANDO DA SILVA ALVES',
    'CASSIA MIRTHYS GONÔøΩALVES DE MOURA RÔøΩGO': 'CASSIA MIRTHYS GON√áALVES DE MOURA R√äGO',
    'MARIA LUIZA SIMÔøΩES': 'MARIA LUIZA SIM√ïES',
    'MARIA DA CONCEIÔøΩÔøΩO DE MELO SILVA': 'MARIA DA CONCEI√á√ÉO DE MELO SILVA',
    'MARIA JOSÔøΩ GOMES DA SILVA PRADO': 'MARIA JOS√â GOMES DA SILVA PRADO',
    'BRENA VALÔøΩRIA DE AZEVEDO EVANGELISTA': 'BRENA VAL√âRIA DE AZEVEDO EVANGELISTA',
    'THIAGO JOSÔøΩ CARVALHO BARBOSA': 'THIAGO JOS√â CARVALHO BARBOSA',
    'GEÔøΩRGIO DE SANTANA GUEDES': 'GE√ìRGIO DE SANTANA GUEDES',
    'ANA LÔøΩCIA RAMOS DE AMORIM ARAGÔøΩO': 'ANA L√öCIA RAMOS DE AMORIM ARAG√ÉO',
    'VITAL E VITOR MATERIAL DE CONSTRUÔøΩÔøΩO LTDA': 'VITAL E VITOR MATERIAL DE CONSTRU√á√ÉO LTDA',
    'RODRIGO DE L. SILVA COMÔøΩRCIO PEÔøΩAS E ACESSÔøΩRIOS': 'RODRIGO DE L. SILVA COM√âRCIO PE√áAS E ACESS√ìRIOS',
    'DIVINA FACÔøΩÔøΩO LTDA': 'DIVINA FAC√á√ÉO LTDA',
    'C?TIA CARNEIRO DA SILVA FIGUEIREDO': 'C√ÅTIA CARNEIRO DA SILVA FIGUEIREDO',
    'Magda Alexandra Alves da Fons?ca': 'MAGDA ALEXANDRA ALVES DA FONSECA',
    'ELIZ?NGELA DA SILVA COSTA': 'ELIZ√ÇNGELA DA SILVA COSTA',
    'LÔøΩVIA MARIA DA SILVA SOUZA': 'L√çVIA MARIA DA SILVA SOUZA',
    'EROTIDES CAROLINE ESTÔøΩVÔøΩO DE ARRUDA': 'EROTIDES CAROLINE EST√äV√ÉO DE ARRUDA',
    'MARIA DE FÔøΩTIMA TAVARES DA SILVA': 'MARIA DE F√ÅTIMA TAVARES DA SILVA',
    'VIRGÔøΩNIA RUFINO DE ALBUQUERQUE': 'VIRG√çNIA RUFINO DE ALBUQUERQUE',
    'RITA DE CÔøΩSSIA PEREIRA DA SILVA': 'RITA DE C√ÅSSIA PEREIRA DA SILVA',
    'FÔøΩBIA VERÔøΩNICA DA SILVA': 'F√ÅBIA VER√îNICA DA SILVA',
    'JÔøΩSSICA PRISCILA SILVA CHAVES': 'J√âSSICA PRISCILA SILVA CHAVES',
    'FAGNA GOMES DE ARAÔøΩJO': 'FAGNA GOMES DE ARA√öJO',
    'ANA CLÔøΩUDIA DE A. SANTOS CRUZ': 'ANA CL√ÅUDIA DE A. SANTOS CRUZ',
    'MARIA RITA DE CÔøΩSSIA DE L. SANTOS': 'MARIA RITA DE C√ÅSSIA DE L. SANTOS',
    'CLÔøΩUDIA PATRÔøΩCIA DE OLIVEIRA RODRIGUES': 'CL√ÅUDIA PATR√çCIA DE OLIVEIRA RODRIGUES',
    'ELISÔøΩNGELA KELLY O. DE MOURA ANICETO': 'ELIS√ÇNGELA KELLY O. DE MOURA ANICETO',
    'MARIA SILVÔøΩNIA DE MOURA': 'MARIA SILV√ÇNIA DE MOURA',
    'ANA CLÔøΩUDIA GOMES DE SOUSA DIAS': 'ANA CL√ÅUDIA GOMES DE SOUSA DIAS',
    'ANA ALICE DA SILVA FÔøΩLIX': 'ANA ALICE DA SILVA F√âLIX',
    'MARIA JOSÔøΩ SOARES DA SILVA': 'MARIA JOS√â SOARES DA SILVA',
    'IARA CAROLINE DA SILVA ARAÔøΩJO': 'IARA CAROLINE DA SILVA ARA√öJO',
    'VALDÔøΩNIA PESSOA DE FARIAS FERREIRA': 'VALD√äNIA PESSOA DE FARIAS FERREIRA',
    'LAÔøΩS CAROLANE DA SILVA SOUZA': 'LA√çS CAROLANE DA SILVA SOUZA',
    'MARIA JOSÔøΩ GUILHERME DA SILVA ALVES': 'MARIA JOS√â GUILHERME DA SILVA ALVES',
    'LETÔøΩCIA VITÔøΩRIA DA SILVA': 'LET√çCIA VIT√ìRIA DA SILVA',
    'ANDRÔøΩIA DE ARAÔøΩJO FERREIRA': 'ANDR√âIA DE ARA√öJO FERREIRA',
    'TAMIRES TAVARES DE ARRUDA BURÔøΩGIO': 'TAMIRES TAVARES DE ARRUDA BUR√âGIO',
    'MARÔøΩLIA GABRIELA FIGUEIREDO DA SILVA': 'MAR√çLIA GABRIELA FIGUEIREDO DA SILVA',
    'MARIA BETÔøΩNIA DO NASCIMENTO': 'MARIA BET√ÇNIA DO NASCIMENTO',
    'JAMANDA TAMIRES TENÔøΩRIO SANTANA': 'JAMANDA TAMIRES TEN√ìRIO SANTANA',
    'MARIA BETÔøΩNIA RIBEIRO DE SOUZA': 'MARIA BET√ÇNIA RIBEIRO DE SOUZA',
    'SUELY DE ARAÔøΩJO PEREIRA LOPES': 'SUELY DE ARA√öJO PEREIRA LOPES',
    'CRISTIANE ARAÔøΩJO SANTANA GOMES': 'CRISTIANE ARA√öJO SANTANA GOMES',
    'CÔøΩSSIA NAIARA DE LIMA SANTOS': 'C√ÅSSIA NAIARA DE LIMA SANTOS',
    'ANA PATRÔøΩCIA OLIVEIRA SILVA': 'ANA PATR√çCIA OLIVEIRA SILVA',
    'BRUNA RAFAELE DE ARAÔøΩJO BEZERRA': 'BRUNA RAFAELE DE ARA√öJO BEZERRA',
    'CÔøΩSSIA MIRELLE DA SILVA OLIVEIRA': 'C√ÅSSIA MIRELLE DA SILVA OLIVEIRA',
    'LUCIANE DE SANTANA HERÔøΩNCIO': 'LUCIANE DE SANTANA HER√äNCIO',
    'MARIA JOSÔøΩ DA SILVA AZEVEDO': 'MARIA JOS√â DA SILVA AZEVEDO',
    'MÔøΩNICA VALÔøΩRIA DE BARROS AQUINO': 'M√îNICA VAL√âRIA DE BARROS AQUINO',
    'PÔøΩMELLA CAMILY PEREIRA DOS SANTOS': 'P√ÇMELLA CAMILY PEREIRA DOS SANTOS',
    'ANNE RAFAELE FIGUERÔøΩDO DA SILVA': 'ANNE RAFAELE FIGUER√äDO DA SILVA',
    'VERALÔøΩCIA RIBEIRO DOS S. MOURA': 'VERAL√öCIA RIBEIRO DOS S. MOURA',
    'MARIA DE FÔøΩTIMA DA SILVA': 'MARIA DE F√ÅTIMA DA SILVA',
    'JULIANA VITÔøΩRIA DE MOURA BERNARDINO': 'JULIANA VIT√ìRIA DE MOURA BERNARDINO',
    'JÔøΩSSICA GOMES DE LUNA': 'J√âSSICA GOMES DE LUNA',
    'CINTIA GOMES DE ABREU AZEVÔøΩDO': 'CINTIA GOMES DE ABREU AZEV√äDO',
    'ROMÔøΩNIA BELO DA SILVA': 'ROM√äNIA BELO DA SILVA',
    'NATALICIA GONÔøΩALVES DE MOURA': 'NATALICIA GON√áALVES DE MOURA',
    'AYANE STEFANE LOURENÔøΩO MARQUES': 'AYANE STEFANE LOUREN√áO MARQUES',
    'ROGÔøΩRIA DO NASCIMENTO ALBUQUERQUE': 'ROG√âRIA DO NASCIMENTO ALBUQUERQUE',
    'DAYENE STHEFANNY MENDONÔøΩA SOUSA': 'DAYENE STHEFANNY MENDON√áA SOUSA',
    'ELIDA TAINARA DA SILVA MENDONÔøΩA': 'ELIDA TAINARA DA SILVA MENDON√áA',
    'ANA LETÔøΩCIA BARBOSA DE AMORIM': 'ANA LET√çCIA BARBOSA DE AMORIM',
    'AMANDA TAMIRES TENÔøΩRIO SANTANA': 'AMANDA TAMIRES TEN√ìRIO SANTANA',
    'MARIA JOSÔøΩ FELIPE NETO': 'MARIA JOS√â FELIPE NETO',
    'LUANA LETÔøΩCIA SOUSA DE OLIVEIRA': 'LUANA LET√çCIA SOUSA DE OLIVEIRA',
    'LEILA CAVALCANTI DE ARAÔøΩJO': 'LEILA CAVALCANTI DE ARA√öJO',
    'Magda Alexandra Alves da FonsÔøΩca': 'MAGDA ALEXANDRA ALVES DA FONSECA',
    'INDUSTRIA E COMÔøΩRCIO DE MÔøΩVEIS KUTZ LTDA': 'INDUSTRIA E COM√âRCIO DE M√ìVEIS KUTZ LTDA',
    'D. FEITOSA ALUGUEL DE MÔøΩQUINAS E EQUIPAMENTO PARA CONSTRUÔøΩÔøΩO EIRELI': 'D. FEITOSA ALUGUEL DE M√ÅQUINAS E EQUIPAMENTO PARA CONSTRU√á√ÉO EIRELI',
    'THALIA ARIADNE PEÔøΩA ARAGÔøΩO': 'THALIA ARIADNE PE√ëA ARAG√ÉO',
    'LEÔøΩNIDAS CARLOS SANTOS DE ALBUQUERQUE': 'LE√îNIDAS CARLOS SANTOS DE ALBUQUERQUE',
    'GUSTAVO HENRIQUE DE ARAGÔøΩO FERREIRA': 'GUSTAVO HENRIQUE DE ARAG√ÉO FERREIRA',
    'QUALINFO SERVIÔøΩOS DE INFORMATICA LTDA EPP': 'QUALINFO SERVI√áOS DE INFORMATICA LTDA EPP',
    'HOSTAZUL / MW ÔøΩGIL': 'HOSTAZUL / MW √ÅGIL',
    'WELLEYSON CÔøΩSAR DA SILVA': 'WELLEYSON C√âSAR DA SILVA',
    'JOÔøΩO MARTINS DE ATHAYDE JÔøΩNIOR - ME': 'JO√ÉO MARTINS DE ATHAYDE J√öNIOR - ME',
    'LINK CARD ADMINISTRADORA DE BENEFÔøΩCIOS EIRELI': 'LINK CARD ADMINISTRADORA DE BENEF√çCIOS EIRELI',
    'JOSÔøΩ ANTÔøΩNIO DE AGUIAR': 'JOS√â ANT√îNIO DE AGUIAR',
    'M. A. DE LIMA DISTRIBUIÔøΩÔøΩO E SERVIÔøΩOS': 'M. A. DE LIMA DISTRIBUI√á√ÉO E SERVI√áOS',
    'ASSOCIAÔøΩÔøΩO SANTO AGOSTINHO': 'ASSOCIA√á√ÉO SANTO AGOSTINHO',
    'ASSOCIAÔøΩÔøΩO DOS AGRICULTORES RURAIS DO SÔøΩTIO QUECEQUE': 'ASSOCIA√á√ÉO DOS AGRICULTORES RURAIS DO S√çTIO QUECEQUE',
    'MIL COMERCIO DE MATERIAIS DE CONSTRUÔøΩÔøΩO EIRELI': 'MIL COMERCIO DE MATERIAIS DE CONSTRU√á√ÉO EIRELI',
    'MARIA JOSÔøΩ DA SILVA': 'MARIA JOS√â DA SILVA',
    'VERÔøΩNICA ROCHA DE CARVALHO ATAIDE': 'VER√îNICA ROCHA DE CARVALHO ATAIDE',
    'LORHANY NATÔøΩRCIA DE ABREU AZEVEDO': 'LORHANY NAT√ÅRCIA DE ABREU AZEVEDO',
    'DIANA FRANÔøΩA COSTA DA SILVA': 'DIANA FRAN√áA COSTA DA SILVA',
    'LUCAS VINÔøΩCIUS DE OLIVERIA ROCHA': 'LUCAS VIN√çCIUS DE OLIVEIRA ROCHA',
    'ANA VALÔøΩRIA DA CRUZ BARBOZA': 'ANA VAL√âRIA DA CRUZ BARBOZA',
    'DAYANE FRANÔøΩA COSTA DA SILVA': 'DAYANE FRAN√áA COSTA DA SILVA',
    'LS SERVIÔøΩOS DE INFORMÔøΩTICA E ELETRÔøΩNICA LTDA EPP': 'LS SERVI√áOS DE INFORM√ÅTICA E ELETR√îNICA LTDA EPP',
    'CONSTRÔøΩI MATERIAIS DIVERSOS EIRELI ME': 'CONSTR√ìI MATERIAIS DIVERSOS EIRELI ME'
}

df['FORNECEDOR'] = df['FORNECEDOR'].replace(mapa_fornecedor)

df['FORNECEDOR'].unique()

"""# **Download**

Area comentada, para baixar, apague
"""

from google.colab import files

# Salva em Excel
#df.to_excel('bd_tratado.xlsx', index=False)

# Faz o download
#files.download('bd_tratado.xlsx')

# Salva em JSON (orienta√ß√£o padr√£o)
df.to_json('bd_tratadoj.json', orient='records', force_ascii=False)

# Faz o download
files.download('bd_tratadoj.json')